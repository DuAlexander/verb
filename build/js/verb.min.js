/*! verb 2015-10-03 */
if("object"!=typeof exports||void 0===exports)var verb=exports={};else var Worker=require("webworker-threads").Worker;if("object"!=typeof window){var global=this,window=global,lookup=function(e,r){var n=global;return e.split(".").forEach(function(e){n&&(n=n[e])}),n?n[r]:null};onmessage=function(e){var r=lookup(e.data.className,e.data.methodName);return r?(postMessage({result:r.apply(null,e.data.args),id:e.data.id}),void 0):console.error("could not find "+e.data.className+"."+e.data.methodName)}}(function($hx_exports){"use strict";function $extend(e,r){function n(){}n.prototype=e;var t=new n;for(var o in r)t[o]=r[o];return r.toString!==Object.prototype.toString&&(t.toString=r.toString),t}function $iterator(e){return e instanceof Array?function(){return HxOverrides.iter(e)}:"function"==typeof e.iterator?$bind(e,e.iterator):e.iterator}function $bind(e,r){if(null==r)return null;null==r.__id__&&(r.__id__=$fid++);var n;return null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[r.__id__],null==n&&(n=function(){return n.method.apply(n.scope,arguments)},n.scope=e,n.method=r,e.hx__closures__[r.__id__]=n),n}$hx_exports.geom=$hx_exports.geom||{},$hx_exports.exe=$hx_exports.exe||{},$hx_exports.eval=$hx_exports.eval||{},$hx_exports.core=$hx_exports.core||{},$hx_exports.promhx=$hx_exports.promhx||{};var $estr=function(){return js.Boot.__string_rec(this,"")},HxOverrides=function(){};HxOverrides.__name__=["HxOverrides"],HxOverrides.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var Lambda=function(){};Lambda.__name__=["Lambda"],Lambda.fold=function(e,r,n){for(var t=$iterator(e)();t.hasNext();){var o=t.next();n=r(o,n)}return n};var List=function(){this.length=0};List.__name__=["List"],List.prototype={add:function(e){var r=[e];null==this.h?this.h=r:this.q[1]=r,this.q=r,this.length++},pop:function(){if(null==this.h)return null;var e=this.h[0];return this.h=this.h[1],null==this.h&&(this.q=null),this.length--,e},isEmpty:function(){return null==this.h}};var IMap=function(){};IMap.__name__=["IMap"],Math.__name__=["Math"];var Type=function(){};Type.__name__=["Type"],Type.getClassName=function(e){var r=e.__name__;return r.join(".")};var haxe={};haxe.Log=function(){},haxe.Log.__name__=["haxe","Log"],haxe.Log.trace=function(e,r){js.Boot.__trace(e,r)},haxe.ds={},haxe.ds.IntMap=function(){this.h={}},haxe.ds.IntMap.__name__=["haxe","ds","IntMap"],haxe.ds.IntMap.__interfaces__=[IMap],haxe.ds.IntMap.prototype={set:function(e,r){this.h[e]=r},get:function(e){return this.h[e]},exists:function(e){return this.h.hasOwnProperty(e)},remove:function(e){return this.h.hasOwnProperty(e)?(delete this.h[e],!0):!1}},haxe.ds.Option={__ename__:!0,__constructs__:["Some","None"]},haxe.ds.Option.Some=function(e){var r=["Some",0,e];return r.__enum__=haxe.ds.Option,r.toString=$estr,r},haxe.ds.Option.None=["None",1],haxe.ds.Option.None.toString=$estr,haxe.ds.Option.None.__enum__=haxe.ds.Option;var js={};js.Boot=function(){},js.Boot.__name__=["js","Boot"],js.Boot.__unhtml=function(e){return e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},js.Boot.__trace=function(e,r){var n;if(n=null!=r?r.fileName+":"+r.lineNumber+": ":"",n+=js.Boot.__string_rec(e,""),null!=r&&null!=r.customParams)for(var t=0,o=r.customParams;o.length>t;){var a=o[t];++t,n+=","+js.Boot.__string_rec(a,"")}var i;"undefined"!=typeof document&&null!=(i=document.getElementById("haxe:trace"))?i.innerHTML+=js.Boot.__unhtml(n)+"<br/>":"undefined"!=typeof console&&null!=console.log&&console.log(n)},js.Boot.__string_rec=function(e,r){if(null==e)return"null";if(r.length>=5)return"<...>";var n=typeof e;switch("function"==n&&(e.__name__||e.__ename__)&&(n="object"),n){case"object":if(e instanceof Array){if(e.__enum__){if(2==e.length)return e[0];var t=e[0]+"(";r+="	";for(var o=2,a=e.length;a>o;){var i=o++;t+=2!=i?","+js.Boot.__string_rec(e[i],r):js.Boot.__string_rec(e[i],r)}return t+")"}var s=e.length,v="[";r+="	";for(var c=0;s>c;){var u=c++;v+=(u>0?",":"")+js.Boot.__string_rec(e[u],r)}return v+="]"}var l;try{l=e.toString}catch(b){return"???"}if(null!=l&&l!=Object.toString){var h=""+e;if("[object Object]"!=h)return h}var f=null,d="{\n";r+="	";var m=null!=e.hasOwnProperty;for(var f in e)(!m||e.hasOwnProperty(f))&&"prototype"!=f&&"__class__"!=f&&"__super__"!=f&&"__interfaces__"!=f&&"__properties__"!=f&&(2!=d.length&&(d+=", \n"),d+=r+f+" : "+js.Boot.__string_rec(e[f],r));return r=r.substring(1),d+="\n"+r+"}";case"function":return"<function>";case"string":return e;default:return e+""}};var promhx={};promhx.base={},promhx.base.AsyncBase=function(e){this._resolved=!1,this._pending=!1,this._errorPending=!1,this._fulfilled=!1,this._update=[],this._error=[],this._errored=!1,null!=e&&promhx.base.AsyncBase.link(e,this,function(e){return e})},promhx.base.AsyncBase.__name__=["promhx","base","AsyncBase"],promhx.base.AsyncBase.link=function(e,r,n){e._update.push({async:r,linkf:function(e){r.handleResolve(n(e))}}),promhx.base.AsyncBase.immediateLinkUpdate(e,r,n)},promhx.base.AsyncBase.immediateLinkUpdate=function(e,r,n){if(e._errored&&r.handleError(e._errorVal),e._resolved&&!e._pending)try{r.handleResolve(n(e._val))}catch(t){r.handleError(t)}},promhx.base.AsyncBase.linkAll=function(e,r){for(var n=function(n,t,o){if(0==n.length||promhx.base.AsyncBase.allFulfilled(n)){for(var a,i=[],s=$iterator(e)();s.hasNext();){var v=s.next();i.push(v==t?o:v._val)}a=i,r.handleResolve(a)}return null},t=$iterator(e)();t.hasNext();){var o=t.next();o._update.push({async:r,linkf:function(e,r,n){return function(t){return e(r,n,t)}}(n,function(){for(var r,n=[],t=$iterator(e)();t.hasNext();){var a=t.next();a!=o&&n.push(a)}return r=n}(this),o)})}promhx.base.AsyncBase.allFulfilled(e)&&r.handleResolve(function(){for(var r,n=[],t=$iterator(e)();t.hasNext();){var o=t.next();n.push(o._val)}return r=n}(this))},promhx.base.AsyncBase.pipeLink=function(e,r,n){var t=!1,o=function(e){if(!t){t=!0;var o=n(e);o._update.push({async:r,linkf:$bind(r,r.handleResolve)}),promhx.base.AsyncBase.immediateLinkUpdate(o,r,function(e){return e})}};if(e._update.push({async:r,linkf:o}),e._resolved&&!e._pending)try{o(e._val)}catch(a){r.handleError(a)}},promhx.base.AsyncBase.allResolved=function(e){for(var r=$iterator(e)();r.hasNext();){var n=r.next();if(!n._resolved)return!1}return!0},promhx.base.AsyncBase.allFulfilled=function(e){for(var r=$iterator(e)();r.hasNext();){var n=r.next();if(!n._fulfilled)return!1}return!0},promhx.base.AsyncBase.prototype={catchError:function(e){return this._error.push(e),this},errorThen:function(e){return this._errorMap=e,this},isResolved:function(){return this._resolved},isErrored:function(){return this._errored},isFulfilled:function(){return this._fulfilled},isPending:function(){return this._pending},handleResolve:function(e){this._resolve(e)},_resolve:function(e){var r=this;this._pending?promhx.base.EventLoop.enqueue(function(e,r){return function(){return e(r)}}($bind(this,this._resolve),e)):(this._resolved=!0,this._pending=!0,promhx.base.EventLoop.queue.add(function(){r._val=e;for(var n=0,t=r._update;t.length>n;){var o=t[n];++n;try{o.linkf(e)}catch(a){o.async.handleError(a)}}r._fulfilled=!0,r._pending=!1}),promhx.base.EventLoop.continueOnNextLoop())},handleError:function(e){this._handleError(e)},_handleError:function(e){var r=this,n=function(e){if(r._error.length>0)for(var n=0,t=r._error;t.length>n;){var o=t[n];++n,o(e)}else{if(!(r._update.length>0))throw e;for(var a=0,i=r._update;i.length>a;){var s=i[a];++a,s.async.handleError(e)}}r._errorPending=!1};this._errorPending||(this._errorPending=!0,this._errored=!0,this._errorVal=e,promhx.base.EventLoop.queue.add(function(){if(null!=r._errorMap)try{r._resolve(r._errorMap(e))}catch(t){n(t)}else n(e)}),promhx.base.EventLoop.continueOnNextLoop())},then:function(e){var r=new promhx.base.AsyncBase;return promhx.base.AsyncBase.link(this,r,e),r},unlink:function(e){var r=this;promhx.base.EventLoop.queue.add(function(){r._update=r._update.filter(function(r){return r.async!=e})}),promhx.base.EventLoop.continueOnNextLoop()},isLinked:function(e){for(var r=!1,n=0,t=this._update;t.length>n;){var o=t[n];if(++n,o.async==e)return!0}return r}},promhx.Deferred=$hx_exports.promhx.Deferred=function(){promhx.base.AsyncBase.call(this)},promhx.Deferred.__name__=["promhx","Deferred"],promhx.Deferred.__super__=promhx.base.AsyncBase,promhx.Deferred.prototype=$extend(promhx.base.AsyncBase.prototype,{resolve:function(e){this.handleResolve(e)},throwError:function(e){this.handleError(e)},promise:function(){return new promhx.Promise(this)},stream:function(){return new promhx.Stream(this)},publicStream:function(){return new promhx.PublicStream(this)}}),promhx.Promise=$hx_exports.promhx.Promise=function(e){promhx.base.AsyncBase.call(this,e),this._rejected=!1},promhx.Promise.__name__=["promhx","Promise"],promhx.Promise.whenAll=function(e){var r=new promhx.Promise;return promhx.base.AsyncBase.linkAll(e,r),r},promhx.Promise.promise=function(e){var r=new promhx.Promise;return r.handleResolve(e),r},promhx.Promise.__super__=promhx.base.AsyncBase,promhx.Promise.prototype=$extend(promhx.base.AsyncBase.prototype,{isRejected:function(){return this._rejected},reject:function(e){this._rejected=!0,this.handleError(e)},handleResolve:function(e){if(this._resolved){var r="Promise has already been resolved";throw promhx.error.PromiseError.AlreadyResolved(r)}this._resolve(e)},then:function(e){var r=new promhx.Promise;return promhx.base.AsyncBase.link(this,r,e),r},unlink:function(e){var r=this;promhx.base.EventLoop.queue.add(function(){if(r._fulfilled)r._update=r._update.filter(function(r){return r.async!=e});else{var n="Downstream Promise is not fullfilled";r.handleError(promhx.error.PromiseError.DownstreamNotFullfilled(n))}}),promhx.base.EventLoop.continueOnNextLoop()},handleError:function(e){this._rejected=!0,this._handleError(e)},pipe:function(e){var r=new promhx.Promise;return promhx.base.AsyncBase.pipeLink(this,r,e),r},errorPipe:function(e){var r=new promhx.Promise;return this.catchError(function(n){var t=e(n);t.then($bind(r,r._resolve))}),this.then($bind(r,r._resolve)),r}}),promhx.Stream=$hx_exports.promhx.Stream=function(e){promhx.base.AsyncBase.call(this,e),this._end_deferred=new promhx.Deferred,this._end_promise=this._end_deferred.promise()},promhx.Stream.__name__=["promhx","Stream"],promhx.Stream.foreach=function(e){for(var r=new promhx.Stream,n=$iterator(e)();n.hasNext();){var t=n.next();r.handleResolve(t)}return r.end(),r},promhx.Stream.wheneverAll=function(e){var r=new promhx.Stream;return promhx.base.AsyncBase.linkAll(e,r),r},promhx.Stream.concatAll=function(e){for(var r=new promhx.Stream,n=$iterator(e)();n.hasNext();){var t=n.next();r.concat(t)}return r},promhx.Stream.mergeAll=function(e){for(var r=new promhx.Stream,n=$iterator(e)();n.hasNext();){var t=n.next();r.merge(t)}return r},promhx.Stream.stream=function(e){var r=new promhx.Stream;return r.handleResolve(e),r},promhx.Stream.__super__=promhx.base.AsyncBase,promhx.Stream.prototype=$extend(promhx.base.AsyncBase.prototype,{then:function(e){var r=new promhx.Stream;return promhx.base.AsyncBase.link(this,r,e),this._end_promise.then(function(){r.end()}),r},detachStream:function(e){for(var r=[],n=!1,t=0,o=this._update;o.length>t;){var a=o[t];++t,a.async==e?n=!0:r.push(a)}return this._update=r,n},first:function(){var e=new promhx.Promise;return this.then(function(r){e._resolved||e.handleResolve(r)}),e},handleResolve:function(e){this._end||this._pause||this._resolve(e)},pause:function(e){null==e&&(e=!this._pause),this._pause=e},pipe:function(e){var r=new promhx.Stream;return promhx.base.AsyncBase.pipeLink(this,r,e),this._end_promise.then(function(){r.end()}),r},errorPipe:function(e){var r=new promhx.Stream;return this.catchError(function(n){var t=e(n);t.then($bind(r,r._resolve)),t._end_promise.then(($_=r._end_promise,$bind($_,$_._resolve)))}),this.then($bind(r,r._resolve)),this._end_promise.then(function(){r.end()}),r},handleEnd:function(){if(this._pending)promhx.base.EventLoop.queue.add($bind(this,this.handleEnd)),promhx.base.EventLoop.continueOnNextLoop();else{if(this._end_promise._resolved)return;this._end=!0;var e;e=this._resolved?haxe.ds.Option.Some(this._val):haxe.ds.Option.None,this._end_promise.handleResolve(e),this._update=[],this._error=[]}},end:function(){return promhx.base.EventLoop.queue.add($bind(this,this.handleEnd)),promhx.base.EventLoop.continueOnNextLoop(),this},endThen:function(e){return this._end_promise.then(e)},filter:function(e){var r=new promhx.Stream;return this._update.push({async:r,linkf:function(n){e(n)&&r.handleResolve(n)}}),promhx.base.AsyncBase.immediateLinkUpdate(this,r,function(e){return e}),r},concat:function(e){var r=new promhx.Stream;return this._update.push({async:r,linkf:$bind(r,r.handleResolve)}),promhx.base.AsyncBase.immediateLinkUpdate(this,r,function(e){return e}),this._end_promise.then(function(){e.pipe(function(e){return r.handleResolve(e),r}),e._end_promise.then(function(){r.end()})}),r},merge:function(e){var r=new promhx.Stream;return this._update.push({async:r,linkf:$bind(r,r.handleResolve)}),e._update.push({async:r,linkf:$bind(r,r.handleResolve)}),promhx.base.AsyncBase.immediateLinkUpdate(this,r,function(e){return e}),promhx.base.AsyncBase.immediateLinkUpdate(e,r,function(e){return e}),r}}),promhx.PublicStream=$hx_exports.promhx.PublicStream=function(e){promhx.Stream.call(this,e)},promhx.PublicStream.__name__=["promhx","PublicStream"],promhx.PublicStream.publicstream=function(e){var r=new promhx.PublicStream;return r.handleResolve(e),r},promhx.PublicStream.__super__=promhx.Stream,promhx.PublicStream.prototype=$extend(promhx.Stream.prototype,{resolve:function(e){this.handleResolve(e)},throwError:function(e){this.handleError(e)},update:function(e){this.handleResolve(e)}}),promhx.base.EventLoop=function(){},promhx.base.EventLoop.__name__=["promhx","base","EventLoop"],promhx.base.EventLoop.enqueue=function(e){promhx.base.EventLoop.queue.add(e),promhx.base.EventLoop.continueOnNextLoop()},promhx.base.EventLoop.set_nextLoop=function(e){if(null!=promhx.base.EventLoop.nextLoop)throw"nextLoop has already been set";return promhx.base.EventLoop.nextLoop=e,promhx.base.EventLoop.nextLoop},promhx.base.EventLoop.queueEmpty=function(){return promhx.base.EventLoop.queue.isEmpty()},promhx.base.EventLoop.finish=function(e){null==e&&(e=1e3);for(var r=null;e-->0&&null!=(r=promhx.base.EventLoop.queue.pop());)r();return promhx.base.EventLoop.queue.isEmpty()},promhx.base.EventLoop.clear=function(){promhx.base.EventLoop.queue=new List},promhx.base.EventLoop.f=function(){var e=promhx.base.EventLoop.queue.pop();null!=e&&e(),promhx.base.EventLoop.queue.isEmpty()||promhx.base.EventLoop.continueOnNextLoop()},promhx.base.EventLoop.continueOnNextLoop=function(){null!=promhx.base.EventLoop.nextLoop?promhx.base.EventLoop.nextLoop(promhx.base.EventLoop.f):setImmediate(promhx.base.EventLoop.f)},promhx.error={},promhx.error.PromiseError={__ename__:!0,__constructs__:["AlreadyResolved","DownstreamNotFullfilled"]},promhx.error.PromiseError.AlreadyResolved=function(e){var r=["AlreadyResolved",0,e];return r.__enum__=promhx.error.PromiseError,r.toString=$estr,r},promhx.error.PromiseError.DownstreamNotFullfilled=function(e){var r=["DownstreamNotFullfilled",1,e];return r.__enum__=promhx.error.PromiseError,r.toString=$estr,r};var verb={};verb.Verb=function(){},verb.Verb.__name__=["verb","Verb"],verb.Verb.main=function(){haxe.Log.trace("verb 2.0.0",{fileName:"Verb.hx",lineNumber:45,className:"verb.Verb",methodName:"main"})},verb.core={},verb.core.AdaptiveRefinementOptions=$hx_exports.core.AdaptiveRefinementOptions=function(){this.minDivsV=1,this.minDivsU=1,this.refine=!0,this.maxDepth=10,this.minDepth=0,this.normTol=.025},verb.core.AdaptiveRefinementOptions.__name__=["verb","core","AdaptiveRefinementOptions"],verb.core.AdaptiveRefinementNode=$hx_exports.core.AdaptiveRefinementNode=function(e,r,n){if(this.srf=e,this.neighbors=null==n?[null,null,null,null]:n,this.corners=r,null==this.corners){var t=e.knotsU[0],o=verb.core.ArrayExtensions.last(e.knotsU),a=e.knotsV[0],i=verb.core.ArrayExtensions.last(e.knotsV);this.corners=[verb.core.SurfacePoint.fromUv(t,a),verb.core.SurfacePoint.fromUv(o,a),verb.core.SurfacePoint.fromUv(o,i),verb.core.SurfacePoint.fromUv(t,i)]}},verb.core.AdaptiveRefinementNode.__name__=["verb","core","AdaptiveRefinementNode"],verb.core.AdaptiveRefinementNode.prototype={isLeaf:function(){return null==this.children},center:function(){return null!=this.centerPoint?this.centerPoint:this.evalSrf(this.u05,this.v05)},evalCorners:function(){this.u05=(this.corners[0].uv[0]+this.corners[2].uv[0])/2,this.v05=(this.corners[0].uv[1]+this.corners[2].uv[1])/2;for(var e=0;4>e;){var r=e++;if(null==this.corners[r].point){var n=this.corners[r];this.evalSrf(n.uv[0],n.uv[1],n)}}},evalSrf:function(e,r,n){var t=verb.eval.Eval.rationalSurfaceDerivatives(this.srf,e,r,1),o=t[0][0],a=verb.core.Vec.cross(t[0][1],t[1][0]),i=verb.core.Vec.isZero(a);return i||(a=verb.core.Vec.normalized(a)),null!=n?(n.degen=i,n.point=o,n.normal=a,n):new verb.core.SurfacePoint(o,a,[e,r],-1,i)},getEdgeCorners:function(e){if(this.isLeaf())return[this.corners[e]];if(this.horizontal)switch(e){case 0:return this.children[0].getEdgeCorners(0);case 1:return this.children[0].getEdgeCorners(1).concat(this.children[1].getEdgeCorners(1));case 2:return this.children[1].getEdgeCorners(2);case 3:return this.children[1].getEdgeCorners(3).concat(this.children[0].getEdgeCorners(3))}switch(e){case 0:return this.children[0].getEdgeCorners(0).concat(this.children[1].getEdgeCorners(0));case 1:return this.children[1].getEdgeCorners(1);case 2:return this.children[1].getEdgeCorners(2).concat(this.children[0].getEdgeCorners(2));case 3:return this.children[0].getEdgeCorners(3)}return null},getAllCorners:function(e){var r=[this.corners[e]];if(null==this.neighbors[e])return r;var n=this.neighbors[e].getEdgeCorners((e+2)%4),t=e%2,o=verb.core.Constants.EPSILON,a=this,i=[function(e){return e.uv[0]>a.corners[0].uv[0]+o&&e.uv[0]<a.corners[2].uv[0]-o},function(e){return e.uv[1]>a.corners[0].uv[1]+o&&e.uv[1]<a.corners[2].uv[1]-o}],s=n.filter(i[t]);return s.reverse(),r.concat(s)},midpoint:function(e){if(null==this.midPoints&&(this.midPoints=[null,null,null,null]),null!=this.midPoints[e])return this.midPoints[e];switch(e){case 0:this.midPoints[0]=this.evalSrf(this.u05,this.corners[0].uv[1]);break;case 1:this.midPoints[1]=this.evalSrf(this.corners[1].uv[0],this.v05);break;case 2:this.midPoints[2]=this.evalSrf(this.u05,this.corners[2].uv[1]);break;case 3:this.midPoints[3]=this.evalSrf(this.corners[0].uv[0],this.v05)}return this.midPoints[e]},hasBadNormals:function(){return this.corners[0].degen||this.corners[1].degen||this.corners[2].degen||this.corners[3].degen},fixNormals:function(){for(var e=this.corners.length,r=0;e>r;){var n=r++;if(this.corners[n],this.corners[n].degen){var t=this.corners[(n+1)%e],o=this.corners[(n+3)%e];this.corners[n].normal=t.degen?o.normal:t.normal}}},shouldDivide:function(e,r){if(e.minDepth>r)return!0;if(r>=e.maxDepth)return!1;if(this.hasBadNormals())return this.fixNormals(),!1;if(this.splitVert=verb.core.Vec.normSquared(verb.core.Vec.sub(this.corners[0].normal,this.corners[1].normal))>e.normTol||verb.core.Vec.normSquared(verb.core.Vec.sub(this.corners[2].normal,this.corners[3].normal))>e.normTol,this.splitHoriz=verb.core.Vec.normSquared(verb.core.Vec.sub(this.corners[1].normal,this.corners[2].normal))>e.normTol||verb.core.Vec.normSquared(verb.core.Vec.sub(this.corners[3].normal,this.corners[0].normal))>e.normTol,this.splitVert||this.splitHoriz)return!0;var n=this.center();return verb.core.Vec.normSquared(verb.core.Vec.sub(n.normal,this.corners[0].normal))>e.normTol||verb.core.Vec.normSquared(verb.core.Vec.sub(n.normal,this.corners[1].normal))>e.normTol||verb.core.Vec.normSquared(verb.core.Vec.sub(n.normal,this.corners[2].normal))>e.normTol||verb.core.Vec.normSquared(verb.core.Vec.sub(n.normal,this.corners[3].normal))>e.normTol},divide:function(e){null==e&&(e=new verb.core.AdaptiveRefinementOptions),null==e.normTol&&(e.normTol=.085),null==e.minDepth&&(e.minDepth=0),null==e.maxDepth&&(e.maxDepth=10),this._divide(e,0,!0)},_divide:function(e,r,n){if(this.evalCorners(),this.shouldDivide(e,r)){if(r++,this.splitVert&&!this.splitHoriz?n=!1:!this.splitVert&&this.splitHoriz&&(n=!0),this.horizontal=n,this.horizontal){var t=[this.corners[0],this.corners[1],this.midpoint(1),this.midpoint(3)],o=[this.midpoint(3),this.midpoint(1),this.corners[2],this.corners[3]];this.children=[new verb.core.AdaptiveRefinementNode(this.srf,t),new verb.core.AdaptiveRefinementNode(this.srf,o)],this.children[0].neighbors=[this.neighbors[0],this.neighbors[1],this.children[1],this.neighbors[3]],this.children[1].neighbors=[this.children[0],this.neighbors[1],this.neighbors[2],this.neighbors[3]]}else{var a=[this.corners[0],this.midpoint(0),this.midpoint(2),this.corners[3]],i=[this.midpoint(0),this.corners[1],this.corners[2],this.midpoint(2)];this.children=[new verb.core.AdaptiveRefinementNode(this.srf,a),new verb.core.AdaptiveRefinementNode(this.srf,i)],this.children[0].neighbors=[this.neighbors[0],this.children[1],this.neighbors[2],this.neighbors[3]],this.children[1].neighbors=[this.neighbors[0],this.neighbors[1],this.neighbors[2],this.children[0]]}for(var s=0,v=this.children;v.length>s;){var c=v[s];++s,c._divide(e,r,!n)}}},triangulate:function(e){if(null==e&&(e=verb.core.MeshData.empty()),this.isLeaf())return this.triangulateLeaf(e);for(var r=0,n=this.children;n.length>r;){var t=n[r];if(++r,null==t)break;t.triangulate(e)}return e},triangulateLeaf:function(e){for(var r=e.points.length,n=[],t=[],o=0,a=0;4>a;){var i=a++,s=this.getAllCorners(i);2==s.length&&(o=i+1);for(var v=0,c=s.length;c>v;){var u=v++;n.push(s[u])}}for(var l=0;n.length>l;){var b=n[l];++l,-1==b.id?(e.uvs.push(b.uv),e.points.push(b.point),e.normals.push(b.normal),b.id=r,t.push(r),r++):t.push(b.id)}if(4==n.length)return e.faces.push([t[0],t[3],t[1]]),e.faces.push([t[3],t[2],t[1]]),e;if(5==n.length){var h=t.length;return e.faces.push([t[o],t[(o+2)%h],t[(o+1)%h]]),e.faces.push([t[(o+4)%h],t[(o+3)%h],t[o]]),e.faces.push([t[o],t[(o+3)%h],t[(o+2)%h]]),e}var f=this.center();e.uvs.push(f.uv),e.points.push(f.point),e.normals.push(f.normal);for(var d=e.points.length-1,m=0,p=n.length-1;n.length>m;)e.faces.push([d,t[m],t[p]]),p=m++;return e}},verb.core.ArrayExtensions=function(){},verb.core.ArrayExtensions.__name__=["verb","core","ArrayExtensions"],verb.core.ArrayExtensions.alloc=function(e,r){if(!(0>r))for(;r>e.length;)e.push(null)},verb.core.ArrayExtensions.reversed=function(e){var r=e.slice();return r.reverse(),r},verb.core.ArrayExtensions.last=function(e){return e[e.length-1]},verb.core.ArrayExtensions.first=function(e){return e[0]},verb.core.ArrayExtensions.spliceAndInsert=function(e,r,n,t){e.splice(r,n),e.splice(r,0,t)},verb.core.ArrayExtensions.left=function(e){if(0==e.length)return[];var r=Math.ceil(e.length/2);return e.slice(0,r)},verb.core.ArrayExtensions.right=function(e){if(0==e.length)return[];var r=Math.ceil(e.length/2);return e.slice(r)},verb.core.ArrayExtensions.rightWithPivot=function(e){if(0==e.length)return[];var r=Math.ceil(e.length/2);return e.slice(r-1)},verb.core.ArrayExtensions.unique=function(e,r){if(0==e.length)return[];for(var n=[e.pop()];e.length>0;){for(var t=e.pop(),o=!0,a=0;n.length>a;){var i=n[a];if(++a,r(t,i)){o=!1;break}}o&&n.push(t)}return n},verb.core.Binomial=function(){},verb.core.Binomial.__name__=["verb","core","Binomial"],verb.core.Binomial.get=function(e,r){if(0==r)return 1;if(0==e||r>e)return 0;if(r>e-r&&(r=e-r),verb.core.Binomial.memo_exists(e,r))return verb.core.Binomial.get_memo(e,r);for(var n=1,t=e,o=1,a=r+1;a>o;){var i=o++;verb.core.Binomial.memo_exists(t,i)?(e--,n=verb.core.Binomial.get_memo(t,i)):(n*=e--,n/=i,verb.core.Binomial.memoize(t,i,n))}return n},verb.core.Binomial.get_no_memo=function(e,r){if(0==r)return 1;if(0==e||r>e)return 0;r>e-r&&(r=e-r);for(var n=1,t=1,o=r+1;o>t;){var a=t++;n*=e--,n/=a}return n},verb.core.Binomial.memo_exists=function(e,r){return verb.core.Binomial.memo.exists(e)&&verb.core.Binomial.memo.get(e).exists(r)},verb.core.Binomial.get_memo=function(e,r){return verb.core.Binomial.memo.get(e).get(r)},verb.core.Binomial.memoize=function(e,r,n){verb.core.Binomial.memo.exists(e)||verb.core.Binomial.memo.set(e,new haxe.ds.IntMap),verb.core.Binomial.memo.get(e).set(r,n)},verb.core.BoundingBox=$hx_exports.core.BoundingBox=function(e){this.max=null,this.min=null,this.dim=3,this.initialized=!1,null!=e&&this.addRange(e)},verb.core.BoundingBox.__name__=["verb","core","BoundingBox"],verb.core.BoundingBox.intervalsOverlap=function(e,r,n,t,o){null==o&&(o=-1);var a;a=-.5>o?verb.core.BoundingBox.TOLERANCE:o;var i=Math.min(e,r)-a,s=Math.max(e,r)+a,v=Math.min(n,t)-a,c=Math.max(n,t)+a;return i>=v&&c>=i||s>=v&&c>=s||v>=i&&s>=v||c>=i&&s>=c},verb.core.BoundingBox.prototype={fromPoint:function(e){return new verb.core.BoundingBox([e])},add:function(e){if(!this.initialized)return this.dim=e.length,this.min=e.slice(0),this.max=e.slice(0),this.initialized=!0,this;for(var r=0,n=this.dim;n>r;){var t=r++;e[t]>this.max[t]&&(this.max[t]=e[t]),e[t]<this.min[t]&&(this.min[t]=e[t])}return this},addRange:function(e){for(var r=e.length,n=0;r>n;){var t=n++;this.add(e[t])}return this},contains:function(e,r){return null==r&&(r=-1),this.initialized?this.intersects(new verb.core.BoundingBox([e]),r):!1},intersects:function(e,r){if(null==r&&(r=-1),!this.initialized||!e.initialized)return!1;for(var n=this.min,t=this.max,o=e.min,a=e.max,i=0,s=this.dim;s>i;){var v=i++;if(!verb.core.BoundingBox.intervalsOverlap(n[v],t[v],o[v],a[v],r))return!1}return!0},clear:function(){return this.initialized=!1,this},getLongestAxis:function(){for(var e=0,r=0,n=0,t=this.dim;t>n;){var o=n++,a=this.getAxisLength(o);a>e&&(e=a,r=o)}return r},getAxisLength:function(e){return 0>e||e>this.dim-1?0:Math.abs(this.min[e]-this.max[e])},intersect:function(e,r){if(!this.initialized)return null;var n=this.min,t=this.max,o=e.min,a=e.max;if(!this.intersects(e,r))return null;for(var i=[],s=[],v=0,c=this.dim;c>v;){var u=v++;i.push(Math.min(t[u],a[u])),s.push(Math.max(n[u],o[u]))}return new verb.core.BoundingBox([s,i])}},verb.core.Constants=$hx_exports.core.Constants=function(){},verb.core.Constants.__name__=["verb","core","Constants"],verb.core.CurveLengthSample=$hx_exports.core.CurveLengthSample=function(e,r){this.u=e,this.len=r},verb.core.CurveLengthSample.__name__=["verb","core","CurveLengthSample"],verb.core.NurbsSurfaceData=$hx_exports.core.NurbsSurfaceData=function(e,r,n,t,o,a,i){null==i&&(i=!1),null==a&&(a=!1),this.degreeU=e,this.degreeV=r,this.knotsU=n,this.knotsV=t,this.controlPoints=o,this.closedU=a,this.closedV=i},verb.core.NurbsSurfaceData.__name__=["verb","core","NurbsSurfaceData"],verb.core.NurbsCurveData=$hx_exports.core.NurbsCurveData=function(e,r,n,t){null==t&&(t=!1),this.degree=e,this.controlPoints=n,this.knots=r,this.closed=t},verb.core.NurbsCurveData.__name__=["verb","core","NurbsCurveData"],verb.core.MeshData=$hx_exports.core.MeshData=function(e,r,n,t){this.faces=e,this.points=r,this.normals=n,this.uvs=t},verb.core.MeshData.__name__=["verb","core","MeshData"],verb.core.MeshData.empty=function(){return new verb.core.MeshData([],[],[],[])},verb.core.PolylineData=$hx_exports.core.PolylineData=function(e,r){this.points=e,this.params=r},verb.core.PolylineData.__name__=["verb","core","PolylineData"],verb.core.VolumeData=$hx_exports.core.VolumeData=function(e,r,n,t,o,a,i){this.degreeU=e,this.degreeV=r,this.degreeW=n,this.knotsU=t,this.knotsV=o,this.knotsW=a,this.controlPoints=i},verb.core.VolumeData.__name__=["verb","core","VolumeData"],verb.core.IBoundingBoxTree=function(){},verb.core.IBoundingBoxTree.__name__=["verb","core","IBoundingBoxTree"],verb.core.CurveCurveIntersection=$hx_exports.core.CurveCurveIntersection=function(e,r,n,t){this.point0=e,this.point1=r,this.u0=n,this.u1=t},verb.core.CurveCurveIntersection.__name__=["verb","core","CurveCurveIntersection"],verb.core.CurveSurfaceIntersection=$hx_exports.core.CurveSurfaceIntersection=function(e,r,n,t){this.u=e,this.uv=r,this.curvePoint=n,this.surfacePoint=t},verb.core.CurveSurfaceIntersection.__name__=["verb","core","CurveSurfaceIntersection"],verb.core.MeshIntersectionPoint=$hx_exports.core.MeshIntersectionPoint=function(e,r,n){this.visited=!1,this.adj=null,this.opp=null,this.uv0=e,this.uv1=r,this.point=n,this.faceIndex0,this.faceIndex1},verb.core.MeshIntersectionPoint.__name__=["verb","core","MeshIntersectionPoint"],verb.core.PolylineMeshIntersection=$hx_exports.core.PolylineMeshIntersection=function(e,r,n,t,o){this.point=e,this.u=r,this.uv=n,this.polylineIndex=t,this.faceIndex=o},verb.core.PolylineMeshIntersection.__name__=["verb","core","PolylineMeshIntersection"],verb.core.SurfaceSurfaceIntersectionPoint=$hx_exports.core.SurfaceSurfaceIntersectionPoint=function(e,r,n,t){this.uv0=e,this.uv1=r,this.point=n,this.dist=t},verb.core.SurfaceSurfaceIntersectionPoint.__name__=["verb","core","SurfaceSurfaceIntersectionPoint"],verb.core.TriSegmentIntersection=$hx_exports.core.TriSegmentIntersection=function(e,r,n,t){this.point=e,this.s=r,this.t=n,this.p=t},verb.core.TriSegmentIntersection.__name__=["verb","core","TriSegmentIntersection"],verb.core.CurveTriPoint=$hx_exports.core.CurveTriPoint=function(e,r,n){this.u=e,this.point=r,this.uv=n},verb.core.CurveTriPoint.__name__=["verb","core","CurveTriPoint"],verb.core.SurfacePoint=function(e,r,n,t,o){null==o&&(o=!1),null==t&&(t=-1),this.uv=n,this.point=e,this.normal=r,this.id=t,this.degen=o},verb.core.SurfacePoint.__name__=["verb","core","SurfacePoint"],verb.core.SurfacePoint.fromUv=function(e,r){return new verb.core.SurfacePoint(null,null,[e,r])},verb.core.CurvePoint=$hx_exports.core.CurvePoint=function(e,r){this.u=e,this.pt=r},verb.core.CurvePoint.__name__=["verb","core","CurvePoint"],verb.core.Interval=$hx_exports.core.Interval=function(e,r){this.min=e,this.max=r},verb.core.Interval.__name__=["verb","core","Interval"],verb.core.KdTree=$hx_exports.core.KdTree=function(e,r){this.dim=3,this.points=e,this.distanceFunction=r,this.dim=e[0].point.length,this.root=this.buildTree(e,0,null)},verb.core.KdTree.__name__=["verb","core","KdTree"],verb.core.KdTree.prototype={buildTree:function(e,r,n){var t,o,a=r%this.dim;return 0==e.length?null:1==e.length?new verb.core.KdNode(e[0],a,n):(e.sort(function(e,r){var n=e.point[a]-r.point[a];return 0==n?0:n>0?1:-1}),t=Math.floor(e.length/2),o=new verb.core.KdNode(e[t],a,n),o.left=this.buildTree(e.slice(0,t),r+1,o),o.right=this.buildTree(e.slice(t+1),r+1,o),o)},nearest:function(e,r,n){var t,o=this,a=new verb.core.BinaryHeap(function(e){return-e.item1}),i=null;i=function(n){for(var t,s,v=n.dimension,c=o.distanceFunction(e,n.kdPoint.point),u=[],l=0,b=o.dim;b>l;)l++,u.push(0);s=u;for(var h,f,d=function(e,n){a.push(new verb.core.Pair(e,n)),a.size()>r&&a.pop()},m=0,p=o.dim;p>m;){var g=m++;s[g]=g==n.dimension?e[g]:n.kdPoint.point[g]}return h=o.distanceFunction(s,n.kdPoint.point),null==n.right&&null==n.left?((r>a.size()||a.peek().item1>c)&&d(n,c),void 0):(t=null==n.right?n.left:null==n.left?n.right:e[v]<n.kdPoint.point[v]?n.left:n.right,i(t),(r>a.size()||a.peek().item1>c)&&d(n,c),(r>a.size()||Math.abs(h)<a.peek().item1)&&(f=t==n.left?n.right:n.left,null!=f&&i(f)),void 0)},t=i;for(var s=0;r>s;)s++,a.push(new verb.core.Pair(null,n));t(this.root);for(var v=[],c=0;r>c;){var u=c++;null!=a.content[u].item0&&v.push(new verb.core.Pair(a.content[u].item0.kdPoint,a.content[u].item1))}return v}},verb.core.BinaryHeap=function(e){this.content=[],this.scoreFunction=e},verb.core.BinaryHeap.__name__=["verb","core","BinaryHeap"],verb.core.BinaryHeap.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],r=this.content.pop();return this.content.length>0&&(this.content[0]=r,this.sinkDown(0)),e},peek:function(){return this.content[0]},remove:function(e){for(var r=this.content.length,n=0;r>n;){var t=n++;if(this.content[t]==e){var o=this.content.pop();
return t!=r-1&&(this.content[t]=o,this.scoreFunction(o)<this.scoreFunction(e)?this.bubbleUp(t):this.sinkDown(t)),void 0}}throw"Node not found."},size:function(){return this.content.length},bubbleUp:function(e){for(var r=this.content[e];e>0;){var n=Math.floor((e+1)/2)-1,t=this.content[n];if(!(this.scoreFunction(r)<this.scoreFunction(t)))break;this.content[n]=r,this.content[e]=t,e=n}},sinkDown:function(e){for(var r=this.content.length,n=this.content[e],t=this.scoreFunction(n);;){var o=2*(e+1),a=o-1,i=-1,s=0;if(r>a){var v=this.content[a];s=this.scoreFunction(v),t>s&&(i=a)}if(r>o){var c=this.content[o],u=this.scoreFunction(c);(-1==i?t:s)>u&&(i=o)}if(-1==i)break;this.content[e]=this.content[i],this.content[i]=n,e=i}}},verb.core.KdPoint=$hx_exports.core.KdPoint=function(e,r){this.point=e,this.obj=r},verb.core.KdPoint.__name__=["verb","core","KdPoint"],verb.core.KdNode=$hx_exports.core.KdNode=function(e,r,n){this.kdPoint=e,this.left=null,this.right=null,this.parent=n,this.dimension=r},verb.core.KdNode.__name__=["verb","core","KdNode"],verb.core.LazyCurveBoundingBoxTree=function(e,r){this._boundingBox=null,this._curve=e,null==r&&(r=verb.core.Vec.domain(this._curve.knots)/64),this._knotTol=r},verb.core.LazyCurveBoundingBoxTree.__name__=["verb","core","LazyCurveBoundingBoxTree"],verb.core.LazyCurveBoundingBoxTree.__interfaces__=[verb.core.IBoundingBoxTree],verb.core.LazyCurveBoundingBoxTree.prototype={split:function(){var e=verb.core.ArrayExtensions.first(this._curve.knots),r=verb.core.ArrayExtensions.last(this._curve.knots),n=r-e,t=verb.eval.Modify.curveSplit(this._curve,(r+e)/2+.1*n*Math.random());return new verb.core.Pair(new verb.core.LazyCurveBoundingBoxTree(t[0],this._knotTol),new verb.core.LazyCurveBoundingBoxTree(t[1],this._knotTol))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new verb.core.BoundingBox(verb.eval.Eval.dehomogenize1d(this._curve.controlPoints))),this._boundingBox},yield:function(){return this._curve},indivisible:function(){return verb.core.Vec.domain(this._curve.knots)<this._knotTol},empty:function(){return!1}},verb.core.LazyMeshBoundingBoxTree=function(e,r){if(this._boundingBox=null,this._mesh=e,null==r){for(var n=[],t=0,o=e.faces.length;o>t;){var a=t++;n.push(a)}r=n}this._faceIndices=r},verb.core.LazyMeshBoundingBoxTree.__name__=["verb","core","LazyMeshBoundingBoxTree"],verb.core.LazyMeshBoundingBoxTree.__interfaces__=[verb.core.IBoundingBoxTree],verb.core.LazyMeshBoundingBoxTree.prototype={split:function(){var e=verb.core.Mesh.sortTrianglesOnLongestAxis(this.boundingBox(),this._mesh,this._faceIndices),r=verb.core.ArrayExtensions.left(e),n=verb.core.ArrayExtensions.right(e);return new verb.core.Pair(new verb.core.LazyMeshBoundingBoxTree(this._mesh,r),new verb.core.LazyMeshBoundingBoxTree(this._mesh,n))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=verb.core.Mesh.makeMeshAabb(this._mesh,this._faceIndices)),this._boundingBox},yield:function(){return this._faceIndices[0]},indivisible:function(){return 1==this._faceIndices.length},empty:function(){return 0==this._faceIndices.length}},verb.core.LazyPolylineBoundingBoxTree=function(e,r){this._boundingBox=null,this._polyline=e,null==r&&(r=new verb.core.Interval(0,0!=e.points.length?e.points.length-1:0)),this._interval=r},verb.core.LazyPolylineBoundingBoxTree.__name__=["verb","core","LazyPolylineBoundingBoxTree"],verb.core.LazyPolylineBoundingBoxTree.__interfaces__=[verb.core.IBoundingBoxTree],verb.core.LazyPolylineBoundingBoxTree.prototype={split:function(){var e=this._interval.min,r=this._interval.max,n=e+Math.ceil((r-e)/2),t=new verb.core.Interval(e,n),o=new verb.core.Interval(n,r);return new verb.core.Pair(new verb.core.LazyPolylineBoundingBoxTree(this._polyline,t),new verb.core.LazyPolylineBoundingBoxTree(this._polyline,o))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new verb.core.BoundingBox(this._polyline.points)),this._boundingBox},yield:function(){return this._interval.min},indivisible:function(){return 1==this._interval.max-this._interval.min},empty:function(){return 0==this._interval.max-this._interval.min}},verb.core.LazySurfaceBoundingBoxTree=function(e,r,n,t){null==r&&(r=!1),this._boundingBox=null,this._surface=e,this._splitV=r,null==n&&(n=verb.core.Vec.domain(e.knotsU)/16),null==t&&(t=verb.core.Vec.domain(e.knotsV)/16),this._knotTolU=n,this._knotTolV=t},verb.core.LazySurfaceBoundingBoxTree.__name__=["verb","core","LazySurfaceBoundingBoxTree"],verb.core.LazySurfaceBoundingBoxTree.__interfaces__=[verb.core.IBoundingBoxTree],verb.core.LazySurfaceBoundingBoxTree.prototype={split:function(){var e,r;this._splitV?(e=verb.core.ArrayExtensions.first(this._surface.knotsV),r=verb.core.ArrayExtensions.last(this._surface.knotsV)):(e=verb.core.ArrayExtensions.first(this._surface.knotsU),r=verb.core.ArrayExtensions.last(this._surface.knotsU));var n=(e+r)/2,t=verb.eval.Modify.surfaceSplit(this._surface,n,this._splitV);return new verb.core.Pair(new verb.core.LazySurfaceBoundingBoxTree(t[0],!this._splitV,this._knotTolU,this._knotTolV),new verb.core.LazySurfaceBoundingBoxTree(t[1],!this._splitV,this._knotTolU,this._knotTolV))},boundingBox:function(){if(null==this._boundingBox){this._boundingBox=new verb.core.BoundingBox;for(var e=0,r=this._surface.controlPoints;r.length>e;){var n=r[e];++e,this._boundingBox.addRange(verb.eval.Eval.dehomogenize1d(n))}}return this._boundingBox},yield:function(){return this._surface},indivisible:function(){return verb.core.Vec.domain(this._surface.knotsV)<this._knotTolV&&verb.core.Vec.domain(this._surface.knotsU)<this._knotTolU},empty:function(){return!1}},verb.core.Mat=$hx_exports.core.Mat=function(){},verb.core.Mat.__name__=["verb","core","Mat"],verb.core.Mat.mul=function(e,r){for(var n=[],t=0,o=r.length;o>t;){var a=t++;n.push(verb.core.Vec.mul(e,r[a]))}return n},verb.core.Mat.mult=function(e,r){var n,t,o,a,i,s,v,c;n=e.length,t=r.length,o=r[0].length,a=[];for(var u=n-1,l=0,b=0;u>=0;){for(i=[],s=e[u],b=o-1;b>=0;){for(v=s[t-1]*r[t-1][b],l=t-2;l>=1;)c=l-1,v+=s[l]*r[l][b]+s[c]*r[c][b],l-=2;0==l&&(v+=s[0]*r[0][b]),i[b]=v,b--}a[u]=i,u--}return a},verb.core.Mat.add=function(e,r){for(var n=[],t=0,o=e.length;o>t;){var a=t++;n.push(verb.core.Vec.add(e[a],r[a]))}return n},verb.core.Mat.div=function(e,r){for(var n=[],t=0,o=e.length;o>t;){var a=t++;n.push(verb.core.Vec.div(e[a],r))}return n},verb.core.Mat.sub=function(e,r){for(var n=[],t=0,o=e.length;o>t;){var a=t++;n.push(verb.core.Vec.sub(e[a],r[a]))}return n},verb.core.Mat.dot=function(e,r){for(var n=[],t=0,o=e.length;o>t;){var a=t++;n.push(verb.core.Vec.dot(e[a],r))}return n},verb.core.Mat.identity=function(e){for(var r=verb.core.Vec.zeros2d(e,e),n=0;e>n;){var t=n++;r[t][t]=1}return r},verb.core.Mat.transpose=function(e){if(0==e.length)return[];for(var r=[],n=0,t=e[0].length;t>n;){var o=n++;r.push(function(){for(var r,n=[],t=0,a=e.length;a>t;){var i=t++;n.push(e[i][o])}return r=n}(this))}return r},verb.core.Mat.solve=function(e,r){return verb.core.Mat.LUsolve(verb.core.Mat.LU(e),r)},verb.core.Mat.LUsolve=function(e,r){var n,t,o,a,i,s=e.LU,v=s.length,c=r.slice(),u=e.P;for(n=v-1;-1!=n;)c[n]=r[n],--n;for(n=0;v>n;){for(o=u[n],u[n]!=n&&(i=c[n],c[n]=c[o],c[o]=i),a=s[n],t=0;n>t;)c[n]-=c[t]*a[t],++t;++n}for(n=v-1;n>=0;){for(a=s[n],t=n+1;v>t;)c[n]-=c[t]*a[t],++t;c[n]/=a[n],--n}return c},verb.core.Mat.LU=function(e){Math.abs;for(var r,n,t,o,a,i,s,v,c,u=[],l=0,b=e.length;b>l;){var h=l++;u.push(e[h].slice())}e=u;var f=e.length,d=f-1,m=[];for(t=0;f>t;){for(s=t,i=e[t],c=Math.abs(i[t]),n=t+1;f>n;)o=Math.abs(e[n][t]),o>c&&(c=o,s=n),++n;for(m[t]=s,s!=t&&(e[t]=e[s],e[s]=i,i=e[t]),a=i[t],r=t+1;f>r;)e[r][t]/=a,++r;for(r=t+1;f>r;){for(v=e[r],n=t+1;d>n;)v[n]-=v[t]*i[n],++n,v[n]-=v[t]*i[n],++n;n==d&&(v[n]-=v[t]*i[n]),++r}++t}return new verb.core.LUDecomp(e,m)},verb.core.LUDecomp=function(e,r){this.LU=e,this.P=r},verb.core.LUDecomp.__name__=["verb","core","LUDecomp"],verb.core.Mesh=$hx_exports.core.Mesh=function(){},verb.core.Mesh.__name__=["verb","core","Mesh"],verb.core.Mesh.getTriangleNorm=function(e,r){var n=e[r[0]],t=e[r[1]],o=e[r[2]],a=verb.core.Vec.sub(t,n),i=verb.core.Vec.sub(o,n),s=verb.core.Vec.cross(a,i);return verb.core.Vec.mul(1/verb.core.Vec.norm(s),s)},verb.core.Mesh.makeMeshAabb=function(e,r){for(var n=new verb.core.BoundingBox,t=0;r.length>t;){var o=r[t];++t,n.add(e.points[e.faces[o][0]]),n.add(e.points[e.faces[o][1]]),n.add(e.points[e.faces[o][2]])}return n},verb.core.Mesh.makeMeshAabbTree=function(e,r){var n=verb.core.Mesh.makeMeshAabb(e,r);if(1==r.length)return new verb.core.BoundingBoxLeaf(n,r[0]);var t=verb.core.Mesh.sortTrianglesOnLongestAxis(n,e,r),o=verb.core.ArrayExtensions.left(t),a=verb.core.ArrayExtensions.right(t);return new verb.core.BoundingBoxInnerNode(n,[verb.core.Mesh.makeMeshAabbTree(e,o),verb.core.Mesh.makeMeshAabbTree(e,a)])},verb.core.Mesh.sortTrianglesOnLongestAxis=function(e,r,n){for(var t=e.getLongestAxis(),o=[],a=0;n.length>a;){var i=n[a];++a;var s=verb.core.Mesh.getMinCoordOnAxis(r.points,r.faces[i],t);o.push(new verb.core.Pair(s,i))}o.sort(function(e,r){var n=e.item0,t=r.item0;return n==t?0:n>t?1:-1});for(var v=[],c=0,u=o.length;u>c;){var l=c++;v.push(o[l].item1)}return v},verb.core.Mesh.getMinCoordOnAxis=function(e,r,n){for(var t=Math.POSITIVE_INFINITY,o=0;3>o;){var a=o++,i=e[r[a]][n];t>i&&(t=i)}return t},verb.core.Mesh.getTriangleCentroid=function(e,r){for(var n=[0,0,0],t=0;3>t;)for(var o=t++,a=0;3>a;){var i=a++;n[i]+=e[r[o]][i]}for(var s=0;3>s;){var v=s++;n[v]/=3}return n},verb.core.Mesh.triangleUVFromPoint=function(e,r,n){var t=e.faces[r],o=e.points[t[0]],a=e.points[t[1]],i=e.points[t[2]],s=e.uvs[t[0]],v=e.uvs[t[1]],c=e.uvs[t[2]],u=verb.core.Vec.sub(o,n),l=verb.core.Vec.sub(a,n),b=verb.core.Vec.sub(i,n),h=verb.core.Vec.norm(verb.core.Vec.cross(verb.core.Vec.sub(o,a),verb.core.Vec.sub(o,i))),f=verb.core.Vec.norm(verb.core.Vec.cross(l,b))/h,d=verb.core.Vec.norm(verb.core.Vec.cross(b,u))/h,m=verb.core.Vec.norm(verb.core.Vec.cross(u,l))/h;return verb.core.Vec.add(verb.core.Vec.mul(f,s),verb.core.Vec.add(verb.core.Vec.mul(d,v),verb.core.Vec.mul(m,c)))},verb.core.BoundingBoxNode=$hx_exports.core.BoundingBoxNode=function(e){this.boundingBox=e},verb.core.BoundingBoxNode.__name__=["verb","core","BoundingBoxNode"],verb.core.BoundingBoxInnerNode=$hx_exports.core.BoundingBoxInnerNode=function(e,r){verb.core.BoundingBoxNode.call(this,e),this.children=r},verb.core.BoundingBoxInnerNode.__name__=["verb","core","BoundingBoxInnerNode"],verb.core.BoundingBoxInnerNode.__super__=verb.core.BoundingBoxNode,verb.core.BoundingBoxInnerNode.prototype=$extend(verb.core.BoundingBoxNode.prototype,{}),verb.core.BoundingBoxLeaf=$hx_exports.core.BoundingBoxLeaf=function(e,r){verb.core.BoundingBoxNode.call(this,e),this.item=r},verb.core.BoundingBoxLeaf.__name__=["verb","core","BoundingBoxLeaf"],verb.core.BoundingBoxLeaf.__super__=verb.core.BoundingBoxNode,verb.core.BoundingBoxLeaf.prototype=$extend(verb.core.BoundingBoxNode.prototype,{}),verb.core.MeshBoundingBoxTree=function(e,r){if(this._empty=!1,this._face=-1,null==r){for(var n=[],t=0,o=e.faces.length;o>t;){var a=t++;n.push(a)}r=n}if(this._boundingBox=verb.core.Mesh.makeMeshAabb(e,r),1>r.length)return this._empty=!0,void 0;if(2>r.length)return this._face=r[0],void 0;var i=verb.core.Mesh.sortTrianglesOnLongestAxis(this._boundingBox,e,r),s=verb.core.ArrayExtensions.left(i),v=verb.core.ArrayExtensions.right(i);this._children=new verb.core.Pair(new verb.core.MeshBoundingBoxTree(e,s),new verb.core.MeshBoundingBoxTree(e,v))},verb.core.MeshBoundingBoxTree.__name__=["verb","core","MeshBoundingBoxTree"],verb.core.MeshBoundingBoxTree.__interfaces__=[verb.core.IBoundingBoxTree],verb.core.MeshBoundingBoxTree.prototype={split:function(){return this._children},boundingBox:function(){return this._boundingBox},yield:function(){return this._face},indivisible:function(){return null==this._children},empty:function(){return this._empty}},verb.core.MinimizationResult=function(e,r,n,t,o,a){this.solution=e,this.value=r,this.gradient=n,this.invHessian=t,this.iterations=o,this.message=a},verb.core.MinimizationResult.__name__=["verb","core","MinimizationResult"],verb.core.Numeric=function(){},verb.core.Numeric.__name__=["verb","core","Numeric"],verb.core.Numeric.numericalGradient=function(e,r){var n=r.length,t=e(r);if(t==Math.NaN)throw"gradient: f(x) is a NaN!";for(var o,a,i,s,v,c,u,l,b,h=r.slice(0),f=[],d=.001,m=0,p=0;n>p;)for(var g=p++,_=Math.max(1e-6*t,1e-8);;){if(++m,m>20)throw"Numerical gradient fails";if(h[g]=r[g]+_,o=e(h),h[g]=r[g]-_,a=e(h),h[g]=r[g],Math.isNaN(o)||Math.isNaN(a))_/=16;else{if(f[g]=(o-a)/(2*_),s=r[g]-_,v=r[g],c=r[g]+_,u=(o-t)/_,l=(t-a)/_,b=verb.core.Vec.max([Math.abs(f[g]),Math.abs(t),Math.abs(o),Math.abs(a),Math.abs(s),Math.abs(v),Math.abs(c),1e-8]),i=Math.min(verb.core.Vec.max([Math.abs(u-f[g]),Math.abs(l-f[g]),Math.abs(u-l)])/b,_/b),!(i>d))break;_/=16}}return f},verb.core.Numeric.uncmin=function(e,r,n,t,o){null==n&&(n=1e-8),null==t&&(t=function(r){return verb.core.Numeric.numericalGradient(e,r)}),null==o&&(o=1e3),r=r.slice(0);var a,i=r.length,s=e(r),v=s;if(Math.isNaN(s))throw"uncmin: f(x0) is a NaN!";n=Math.max(n,verb.core.Constants.EPSILON);var c,u,l,b,h,f,d,m,p,g=verb.core.Mat.identity(i),_=0,x=[],V="";for(u=t(r);o>_;){if(!verb.core.Vec.all(verb.core.Vec.finite(u))){V="Gradient has Infinity or NaN";break}if(c=verb.core.Vec.neg(verb.core.Mat.dot(g,u)),!verb.core.Vec.all(verb.core.Vec.finite(c))){V="Search direction has Infinity or NaN";break}if(p=verb.core.Vec.norm(c),n>p){V="Newton step smaller than tol";break}for(m=1,a=verb.core.Vec.dot(u,c),b=r;o>_&&!(n>m*p)&&(x=verb.core.Vec.mul(m,c),b=verb.core.Vec.add(r,x),v=e(b),v-s>=.1*m*a||Math.isNaN(v));)m*=.5,++_;if(n>m*p){V="Line search step size smaller than tol";break}if(_==o){V="maxit reached during line search";break}l=t(b),h=verb.core.Vec.sub(l,u),d=verb.core.Vec.dot(h,x),f=verb.core.Mat.dot(g,h),g=verb.core.Mat.sub(verb.core.Mat.add(g,verb.core.Mat.mul((d+verb.core.Vec.dot(h,f))/(d*d),verb.core.Numeric.tensor(x,x))),verb.core.Mat.div(verb.core.Mat.add(verb.core.Numeric.tensor(f,x),verb.core.Numeric.tensor(x,f)),d)),r=b,s=v,u=l,++_}return new verb.core.MinimizationResult(r,s,u,g,_,V)},verb.core.Numeric.tensor=function(e,r){for(var n,t,o=e.length,a=r.length,i=[],s=o-1;s>=0;){n=[],t=e[s];for(var v=a-1;v>=3;)n[v]=t*r[v],--v,n[v]=t*r[v],--v,n[v]=t*r[v],--v,n[v]=t*r[v],--v;for(;v>=0;)n[v]=t*r[v],--v;i[s]=n,s--}return i},verb.core.Pair=$hx_exports.core.Pair=function(e,r){this.item0=e,this.item1=r},verb.core.Pair.__name__=["verb","core","Pair"],verb.core.Ray=$hx_exports.core.Ray=function(e,r){this.origin=e,this.dir=r},verb.core.Ray.__name__=["verb","core","Ray"],verb.core.SurfaceBoundingBoxTree=function(e,r,n,t){null==r&&(r=!1),this._boundingBox=null,this._surface=e,null==n&&(n=verb.core.Vec.domain(e.knotsU)/16),null==t&&(t=verb.core.Vec.domain(e.knotsV)/16);var o=!1;if(o=r?verb.core.Vec.domain(this._surface.knotsV)>t:verb.core.Vec.domain(this._surface.knotsU)>n){var a,i;r?(a=verb.core.ArrayExtensions.first(this._surface.knotsV),i=verb.core.ArrayExtensions.last(this._surface.knotsV)):(a=verb.core.ArrayExtensions.first(this._surface.knotsU),i=verb.core.ArrayExtensions.last(this._surface.knotsU));var s=i-a,v=(a+i)/2+.1*s*Math.random(),c=verb.eval.Modify.surfaceSplit(this._surface,v,r);this._children=new verb.core.Pair(new verb.core.SurfaceBoundingBoxTree(c[0],!r,n,t),new verb.core.SurfaceBoundingBoxTree(c[1],!r,n,t))}},verb.core.SurfaceBoundingBoxTree.__name__=["verb","core","SurfaceBoundingBoxTree"],verb.core.SurfaceBoundingBoxTree.__interfaces__=[verb.core.IBoundingBoxTree],verb.core.SurfaceBoundingBoxTree.prototype={split:function(){return this._children},boundingBox:function(){if(null==this._boundingBox){this._boundingBox=new verb.core.BoundingBox;for(var e=0,r=this._surface.controlPoints;r.length>e;){var n=r[e];++e,this._boundingBox.addRange(verb.eval.Eval.dehomogenize1d(n))}}return this._boundingBox},yield:function(){return this._surface},indivisible:function(){return null==this._children},empty:function(){return!1}},verb.core.Trig=$hx_exports.core.Trig=function(){},verb.core.Trig.__name__=["verb","core","Trig"],verb.core.Trig.isPointInPlane=function(e,r,n){return n>Math.abs(verb.core.Vec.dot(verb.core.Vec.sub(e,r.o),r.n))},verb.core.Trig.distToSegment=function(e,r,n){var t=verb.core.Trig.segmentClosestPoint(r,e,n,0,1);return verb.core.Vec.dist(r,t.pt)},verb.core.Trig.rayClosestPoint=function(e,r,n){var t=verb.core.Vec.sub(e,r),o=verb.core.Vec.dot(t,n),a=verb.core.Vec.add(r,verb.core.Vec.mul(o,n));return a},verb.core.Trig.distToRay=function(e,r,n){var t=verb.core.Trig.rayClosestPoint(e,r,n),o=verb.core.Vec.sub(t,e);return verb.core.Vec.norm(o)},verb.core.Trig.threePointsAreFlat=function(e,r,n,t){var o=verb.core.Vec.sub(r,e),a=verb.core.Vec.sub(n,e),i=verb.core.Vec.cross(o,a),s=verb.core.Vec.dot(i,i);return t>s},verb.core.Trig.segmentClosestPoint=function(e,r,n,t,o){var a=verb.core.Vec.sub(n,r),i=verb.core.Vec.norm(a);if(verb.core.Constants.EPSILON>i)return{u:t,pt:r};var s=r,v=verb.core.Vec.mul(1/i,a),c=verb.core.Vec.sub(e,s),u=verb.core.Vec.dot(c,v);return 0>u?{u:t,pt:r}:u>i?{u:o,pt:n}:{u:t+(o-t)*u/i,pt:verb.core.Vec.add(s,verb.core.Vec.mul(u,v))}},verb.core.Vec=$hx_exports.core.Vec=function(){},verb.core.Vec.__name__=["verb","core","Vec"],verb.core.Vec.angleBetween=function(e,r){return Math.acos(verb.core.Vec.dot(e,r)/(verb.core.Vec.norm(e)*verb.core.Vec.norm(r)))},verb.core.Vec.positiveAngleBetween=function(e,r,n){var t=verb.core.Vec.cross(e,r),o=verb.core.Vec.norm(e),a=verb.core.Vec.norm(r),i=o*a,s=verb.core.Vec.dot(e,r),v=verb.core.Vec.norm(t)/i,c=s/i,u=Math.atan2(v,c),l=verb.core.Vec.dot(n,t);return Math.abs(l)<verb.core.Constants.EPSILON?u:l>0?u:-u},verb.core.Vec.signedAngleBetween=function(e,r,n){var t=verb.core.Vec.cross(e,r),o=verb.core.Vec.norm(e),a=verb.core.Vec.norm(r),i=o*a,s=verb.core.Vec.dot(e,r),v=verb.core.Vec.norm(t)/i,c=s/i,u=Math.atan2(v,c),l=verb.core.Vec.dot(n,t);return l>0?u:2*Math.PI-u},verb.core.Vec.angleBetweenNormalized2d=function(e,r){var n=e[0]*r[1]-e[1]*r[0];return Math.atan2(n,verb.core.Vec.dot(e,r))},verb.core.Vec.domain=function(e){return verb.core.ArrayExtensions.last(e)-verb.core.ArrayExtensions.first(e)},verb.core.Vec.range=function(e){for(var r=[],n=0,t=0;e>t;)t++,r.push(n),n+=1;return r},verb.core.Vec.span=function(e,r,n){if(null==n)return[];if(verb.core.Constants.EPSILON>n)return[];if(e>r&&n>0)return[];if(r>e&&0>n)return[];for(var t=[],o=e;r>=o;)t.push(o),o+=n;return t},verb.core.Vec.neg=function(e){return e.map(function(e){return-e})},verb.core.Vec.min=function(e){return Lambda.fold(e,function(e,r){return Math.min(e,r)},Math.POSITIVE_INFINITY)},verb.core.Vec.max=function(e){return Lambda.fold(e,function(e,r){return Math.max(e,r)},Math.NEGATIVE_INFINITY)},verb.core.Vec.all=function(e){return Lambda.fold(e,function(e,r){return r&&e},!0)},verb.core.Vec.finite=function(e){return e.map(function(e){return Math.isFinite(e)})},verb.core.Vec.onRay=function(e,r,n){return verb.core.Vec.add(e,verb.core.Vec.mul(n,r))},verb.core.Vec.lerp=function(e,r,n){return verb.core.Vec.add(verb.core.Vec.mul(e,r),verb.core.Vec.mul(1-e,n))},verb.core.Vec.normalized=function(e){return verb.core.Vec.div(e,verb.core.Vec.norm(e))},verb.core.Vec.cross=function(e,r){return[e[1]*r[2]-e[2]*r[1],e[2]*r[0]-e[0]*r[2],e[0]*r[1]-e[1]*r[0]]},verb.core.Vec.dist=function(e,r){return verb.core.Vec.norm(verb.core.Vec.sub(e,r))},verb.core.Vec.distSquared=function(e,r){return verb.core.Vec.normSquared(verb.core.Vec.sub(e,r))},verb.core.Vec.sum=function(e){return Lambda.fold(e,function(e,r){return r+e},0)},verb.core.Vec.addAll=function(e){var r=$iterator(e)();if(!r.hasNext())return null;var n=r.next().length;return Lambda.fold(e,function(e,r){return verb.core.Vec.add(r,e)},verb.core.Vec.rep(n,0))},verb.core.Vec.norm=function(e){var r=verb.core.Vec.normSquared(e);return 0!=r?Math.sqrt(r):r},verb.core.Vec.normSquared=function(e){return Lambda.fold(e,function(e,r){return r+e*e},0)},verb.core.Vec.rep=function(e,r){for(var n=[],t=0;e>t;)t++,n.push(r);return n},verb.core.Vec.zeros1d=function(e){for(var r=[],n=0;e>n;)n++,r.push(0);return r},verb.core.Vec.zeros2d=function(e,r){for(var n=[],t=0;e>t;)t++,n.push(verb.core.Vec.zeros1d(r));return n},verb.core.Vec.zeros3d=function(e,r,n){for(var t=[],o=0;e>o;)o++,t.push(verb.core.Vec.zeros2d(r,n));return t},verb.core.Vec.dot=function(e,r){for(var n=0,t=0,o=e.length;o>t;){var a=t++;n+=e[a]*r[a]}return n},verb.core.Vec.add=function(e,r){for(var n=[],t=0,o=e.length;o>t;){var a=t++;n.push(e[a]+r[a])}return n},verb.core.Vec.mul=function(e,r){for(var n=[],t=0,o=r.length;o>t;){var a=t++;n.push(e*r[a])}return n},verb.core.Vec.div=function(e,r){for(var n=[],t=0,o=e.length;o>t;){var a=t++;n.push(e[a]/r)}return n},verb.core.Vec.sub=function(e,r){for(var n=[],t=0,o=e.length;o>t;){var a=t++;n.push(e[a]-r[a])}return n},verb.core.Vec.isZero=function(e){for(var r=0,n=e.length;n>r;){var t=r++;if(Math.abs(e[t])>verb.core.Constants.TOLERANCE)return!1}return!0},verb.core.Vec.sortedSetUnion=function(e,r){for(var n=[],t=0,o=0;e.length>t||r.length>o;)if(t>=e.length)n.push(r[o]),o++;else if(o>=r.length)n.push(e[t]),t++;else{var a=e[t]-r[o];Math.abs(a)<verb.core.Constants.EPSILON?(n.push(e[t]),t++,o++):a>0?(n.push(r[o]),o++):(n.push(e[t]),t++)}return n},verb.core.Vec.sortedSetSub=function(e,r){for(var n=[],t=0,o=0;e.length>t;)o>=r.length?(n.push(e[t]),t++):Math.abs(e[t]-r[o])<verb.core.Constants.EPSILON?(t++,o++):(n.push(e[t]),t++);return n},verb.eval={},verb.eval.Analyze=$hx_exports.eval.Analyze=function(){},verb.eval.Analyze.__name__=["verb","eval","Analyze"],verb.eval.Analyze.knotMultiplicities=function(e){for(var r=[new verb.eval.KnotMultiplicity(e[0],0)],n=r[0],t=0;e.length>t;){var o=e[t];++t,Math.abs(o-n.knot)>verb.core.Constants.EPSILON&&(n=new verb.eval.KnotMultiplicity(o,0),r.push(n)),n.inc()}return r},verb.eval.Analyze.isRationalSurfaceClosed=function(e,r){null==r&&(r=!0);var n;n=r?e.controlPoints:verb.core.Mat.transpose(e.controlPoints);for(var t=0,o=n[0].length;o>t;){var a=t++,i=verb.core.Vec.dist(verb.core.ArrayExtensions.first(n)[a],verb.core.ArrayExtensions.last(n)[a])<verb.core.Constants.EPSILON;if(!i)return!1}return!0},verb.eval.Analyze.rationalSurfaceClosestPoint=function(e,r){var n=verb.eval.Analyze.rationalSurfaceClosestParam(e,r);return verb.eval.Eval.rationalSurfacePoint(e,n[0],n[1])},verb.eval.Analyze.rationalSurfaceClosestParam=function(e,r){for(var n,t,o,a=5,i=0,s=1e-4,v=5e-4,c=e.knotsU[0],u=verb.core.ArrayExtensions.last(e.knotsU),l=e.knotsV[0],b=verb.core.ArrayExtensions.last(e.knotsV),h=verb.eval.Analyze.isRationalSurfaceClosed(e),f=verb.eval.Analyze.isRationalSurfaceClosed(e,!1),d=verb.eval.Tess.rationalSurfaceAdaptive(e,new verb.core.AdaptiveRefinementOptions),m=Math.POSITIVE_INFINITY,p=0,g=d.points.length;g>p;){var _=p++,x=d.points[_],V=verb.core.Vec.normSquared(verb.core.Vec.sub(r,x));m>V&&(m=V,o=d.uvs[_])}for(var y=function(r){return verb.eval.Eval.rationalSurfaceDerivatives(e,r[0],r[1],2)},S=function(e,r,n){var t=r[1][0],o=r[0][1],a=r[2][0],i=r[0][2],s=r[1][1],v=r[1][1],c=verb.core.Vec.dot(t,n),u=verb.core.Vec.dot(o,n),l=[-c,-u],b=verb.core.Vec.dot(t,t)+verb.core.Vec.dot(a,n),h=verb.core.Vec.dot(t,o)+verb.core.Vec.dot(s,n),f=verb.core.Vec.dot(t,o)+verb.core.Vec.dot(v,n),d=verb.core.Vec.dot(o,o)+verb.core.Vec.dot(i,n),m=[[b,h],[f,d]],p=verb.core.Mat.solve(m,l);return verb.core.Vec.add(p,e)};a>i;){n=y(o),t=verb.core.Vec.sub(n[0][0],r);var E=verb.core.Vec.norm(t),P=verb.core.Vec.dot(n[1][0],t),M=verb.core.Vec.norm(n[1][0])*E,k=verb.core.Vec.dot(n[0][1],t),I=verb.core.Vec.norm(n[0][1])*E,A=P/M,N=k/I,C=s>E,B=v>A,w=v>N;if(C&&B&&w)return o;var L=S(o,n,t);c>L[0]?L=h?[u-(L[0]-c),L[1]]:[c+verb.core.Constants.EPSILON,L[1]]:L[0]>u&&(L=h?[c+(L[0]-u),L[1]]:[u-verb.core.Constants.EPSILON,L[1]]),l>L[1]?L=f?[L[0],b-(L[1]-l)]:[L[0],l+verb.core.Constants.EPSILON]:L[1]>b&&(L=f?[L[0],l+(L[0]-b)]:[L[0],b-verb.core.Constants.EPSILON]);var T=verb.core.Vec.norm(verb.core.Vec.mul(L[0]-o[0],n[1][0])),z=verb.core.Vec.norm(verb.core.Vec.mul(L[1]-o[1],n[0][1]));if(s>T+z)return o;o=L,i++}return o},verb.eval.Analyze.rationalCurveClosestPoint=function(e,r){return verb.eval.Eval.rationalCurvePoint(e,verb.eval.Analyze.rationalCurveClosestParam(e,r))},verb.eval.Analyze.rationalCurveClosestParam=function(e,r){for(var n=Math.POSITIVE_INFINITY,t=0,o=verb.eval.Tess.rationalCurveRegularSample(e,e.controlPoints.length*e.degree,!0),a=0,i=o.length-1;i>a;){var s=a++,v=o[s][0],c=o[s+1][0],u=o[s].slice(1),l=o[s+1].slice(1),b=verb.core.Trig.segmentClosestPoint(r,u,l,v,c),h=verb.core.Vec.norm(verb.core.Vec.sub(r,b.pt));n>h&&(n=h,t=b.u)}for(var f,d,m=5,p=0,g=1e-4,_=5e-4,x=e.knots[0],V=verb.core.ArrayExtensions.last(e.knots),y=verb.core.Vec.normSquared(verb.core.Vec.sub(e.controlPoints[0],verb.core.ArrayExtensions.last(e.controlPoints)))<verb.core.Constants.EPSILON,S=t,E=function(r){return verb.eval.Eval.rationalCurveDerivatives(e,r,2)},P=function(e,r,n){var t=verb.core.Vec.dot(r[1],n),o=verb.core.Vec.dot(r[2],n),a=verb.core.Vec.dot(r[1],r[1]),i=o+a;return e-t/i};m>p;){f=E(S),d=verb.core.Vec.sub(f[0],r);var M=verb.core.Vec.norm(d),k=verb.core.Vec.dot(f[1],d),I=verb.core.Vec.norm(f[1])*M,A=k/I,N=g>M,C=_>Math.abs(A);if(N&&C)return S;var B=P(S,f,d);x>B?B=y?V-(B-x):x:B>V&&(B=y?x+(B-V):V);var w=verb.core.Vec.norm(verb.core.Vec.mul(B-S,f[1]));if(g>w)return S;S=B,p++}return S},verb.eval.Analyze.rationalCurveParamAtArcLength=function(e,r,n,t,o){if(null==n&&(n=.001),verb.core.Constants.EPSILON>r)return e.knots[0];var a;a=null!=t?t:verb.eval.Modify.decomposeCurveIntoBeziers(e);var i=0;a[i];var s,v=-verb.core.Constants.EPSILON;for(s=null!=o?o:[];r>v&&a.length>i;){if(s[i]=s.length>i?s[i]:verb.eval.Analyze.rationalBezierCurveArcLength(e),v+=s[i],v+verb.core.Constants.EPSILON>r)return verb.eval.Analyze.rationalBezierCurveParamAtArcLength(e,r,n,s[i]);i++}return-1},verb.eval.Analyze.rationalBezierCurveParamAtArcLength=function(e,r,n,t){if(0>r)return e.knots[0];var o;if(o=null!=t?t:verb.eval.Analyze.rationalBezierCurveArcLength(e),r>o)return verb.core.ArrayExtensions.last(e.knots);var a,i=e.knots[0],s=0,v=verb.core.ArrayExtensions.last(e.knots),c=o,u=0,l=0;for(a=null!=n?n:2*verb.core.Constants.TOLERANCE;c-s>a;)u=(i+v)/2,l=verb.eval.Analyze.rationalBezierCurveArcLength(e,u),l>r?(v=u,c=l):(i=u,s=l);return(i+v)/2},verb.eval.Analyze.rationalCurveArcLength=function(e,r,n){null==n&&(n=16),r=null==r?verb.core.ArrayExtensions.last(e.knots):r;for(var t=verb.eval.Modify.decomposeCurveIntoBeziers(e),o=0,a=t[0],i=0;t.length>o&&r>a.knots[0]+verb.core.Constants.EPSILON;){var s=Math.min(verb.core.ArrayExtensions.last(a.knots),r);i+=verb.eval.Analyze.rationalBezierCurveArcLength(a,s,n),a=t[++o]}return i},verb.eval.Analyze.rationalBezierCurveArcLength=function(e,r,n){null==n&&(n=16);var t;t=null==r?verb.core.ArrayExtensions.last(e.knots):r;for(var o,a,i=(t-e.knots[0])/2,s=0,v=e.degree+n,c=0;v>c;){var u=c++;o=i*verb.eval.Analyze.Tvalues[v][u]+i+e.knots[0],a=verb.eval.Eval.rationalCurveDerivatives(e,o,1),s+=verb.eval.Analyze.Cvalues[v][u]*verb.core.Vec.norm(a[1])}return i*s},verb.eval.KnotMultiplicity=$hx_exports.eval.KnotMultiplicity=function(e,r){this.knot=e,this.mult=r},verb.eval.KnotMultiplicity.__name__=["verb","eval","KnotMultiplicity"],verb.eval.KnotMultiplicity.prototype={inc:function(){this.mult++}},verb.eval.Check=$hx_exports.eval.Check=function(){},verb.eval.Check.__name__=["verb","eval","Check"],verb.eval.Check.isValidKnotVector=function(e,r){if(0==e.length)return!1;if(2*(r+1)>e.length)return!1;for(var n=verb.core.ArrayExtensions.first(e),t=0,o=r+1;o>t;){var a=t++;if(Math.abs(e[a]-n)>verb.core.Constants.EPSILON)return!1}n=verb.core.ArrayExtensions.last(e);for(var i=e.length-r-1,s=e.length;s>i;){var v=i++;if(Math.abs(e[v]-n)>verb.core.Constants.EPSILON)return!1}return verb.eval.Check.isNonDecreasing(e)},verb.eval.Check.isNonDecreasing=function(e){for(var r=verb.core.ArrayExtensions.first(e),n=0,t=e.length;t>n;){var o=n++;if(e[o]<r-verb.core.Constants.EPSILON)return!1;r=e[o]}return!0},verb.eval.Check.nurbsCurveData=function(e){if(null==e.controlPoints)throw"Control points array cannot be null!";if(null==e.degree)throw"Degree cannot be null!";if(1>e.degree)throw"Degree must be greater than 1!";if(null==e.knots)throw"Knots cannot be null!";if(e.knots.length!=e.controlPoints.length+e.degree+1)throw"controlPoints.length + degree + 1 must equal knots.length!";if(!verb.eval.Check.isValidKnotVector(e.knots,e.degree))throw"Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!";return e},verb.eval.Check.nurbsSurfaceData=function(e){if(null==e.controlPoints)throw"Control points array cannot be null!";if(null==e.degreeU)throw"DegreeU cannot be null!";if(null==e.degreeV)throw"DegreeV cannot be null!";if(1>e.degreeU)throw"DegreeU must be greater than 1!";if(1>e.degreeV)throw"DegreeV must be greater than 1!";if(null==e.knotsU)throw"KnotsU cannot be null!";if(null==e.knotsV)throw"KnotsV cannot be null!";if(e.knotsU.length!=e.controlPoints.length+e.degreeU+1)throw"controlPointsU.length + degreeU + 1 must equal knotsU.length!";if(e.knotsV.length!=e.controlPoints[0].length+e.degreeV+1)throw"controlPointsV.length + degreeV + 1 must equal knotsV.length!";if(!verb.eval.Check.isValidKnotVector(e.knotsU,e.degreeU)||!verb.eval.Check.isValidKnotVector(e.knotsV,e.degreeV))throw"Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!";return e},verb.eval.Divide=$hx_exports.eval.Divide=function(){},verb.eval.Divide.__name__=["verb","eval","Divide"],verb.eval.Divide.rationalCurveByEqualArcLength=function(e,r){var n=verb.eval.Analyze.rationalCurveArcLength(e),t=n/r;return verb.eval.Divide.rationalCurveByArcLength(e,t)},verb.eval.Divide.rationalCurveByArcLength=function(e,r){var n=verb.eval.Modify.decomposeCurveIntoBeziers(e),t=n.map(function(e){return verb.eval.Analyze.rationalBezierCurveArcLength(e)}),o=verb.core.Vec.sum(t),a=[new verb.core.CurveLengthSample(e.knots[0],0)];if(r>o)return a;for(var i,s=r,v=0,c=s,u=0,l=0;n.length>v;){for(u+=t[v];u+verb.core.Constants.EPSILON>c;)i=verb.eval.Analyze.rationalBezierCurveParamAtArcLength(n[v],c-l,verb.core.Constants.TOLERANCE,t[v]),a.push(new verb.core.CurveLengthSample(i,c)),c+=s;l+=t[v],v++}return a},verb.eval.Eval=$hx_exports.eval.Eval=function(){},verb.eval.Eval.__name__=["verb","eval","Eval"],verb.eval.Eval.volumePoint=function(e,r,n,t){var o=e.knotsU.length-e.degreeU-2,a=e.knotsV.length-e.degreeV-2,i=e.knotsW.length-e.degreeW-2;return verb.eval.Eval.volumePointGivenNML(e,o,a,i,r,n,t)},verb.eval.Eval.volumePointGivenNML=function(e,r,n,t,o,a,i){if(!verb.eval.Eval.areValidRelations(e.degreeU,e.controlPoints.length,e.knotsU.length)||!verb.eval.Eval.areValidRelations(e.degreeV,e.controlPoints[0].length,e.knotsV.length)||!verb.eval.Eval.areValidRelations(e.degreeW,e.controlPoints[0][0].length,e.knotsW.length))throw"Invalid relations between control points and knot vector";for(var s=e.controlPoints,v=e.degreeU,c=e.degreeV,u=e.degreeW,l=e.knotsU,b=e.knotsV,h=e.knotsW,f=s[0][0][0].length,d=verb.eval.Eval.knotSpanGivenN(r,v,o,l),m=verb.eval.Eval.knotSpanGivenN(n,c,a,b),p=verb.eval.Eval.knotSpanGivenN(t,u,i,h),g=verb.eval.Eval.basisFunctionsGivenKnotSpanIndex(d,o,v,l),_=verb.eval.Eval.basisFunctionsGivenKnotSpanIndex(m,a,c,b),x=verb.eval.Eval.basisFunctionsGivenKnotSpanIndex(p,i,u,h),V=d-v,y=verb.core.Vec.zeros1d(f),S=verb.core.Vec.zeros1d(f),E=verb.core.Vec.zeros1d(f),P=0,M=u+1;M>P;){var k=P++;E=verb.core.Vec.zeros1d(f);for(var I=p-u+k,A=0,N=c+1;N>A;){var C=A++;S=verb.core.Vec.zeros1d(f);for(var B=m-c+C,w=0,L=v+1;L>w;){var T=w++;S=verb.core.Vec.add(S,verb.core.Vec.mul(g[T],s[V+T][B][I]))}E=verb.core.Vec.add(E,verb.core.Vec.mul(_[C],S))}y=verb.core.Vec.add(y,verb.core.Vec.mul(x[k],E))}return y},verb.eval.Eval.rationalCurveTangent=function(e,r){var n=verb.eval.Eval.rationalCurveDerivatives(e,r,1);return n[1]},verb.eval.Eval.rationalSurfaceNormal=function(e,r,n){var t=verb.eval.Eval.rationalSurfaceDerivatives(e,r,n,1);
return verb.core.Vec.cross(t[1][0],t[0][1])},verb.eval.Eval.rationalSurfaceDerivatives=function(e,r,n,t){null==t&&(t=1);for(var o=verb.eval.Eval.surfaceDerivatives(e,r,n,t),a=verb.eval.Eval.rational2d(o),i=verb.eval.Eval.weight2d(o),s=[],v=a[0][0].length,c=0,u=t+1;u>c;){var l=c++;s.push([]);for(var b=0,h=t-l+1;h>b;){for(var f=b++,d=a[l][f],m=1,p=f+1;p>m;){var g=m++;d=verb.core.Vec.sub(d,verb.core.Vec.mul(verb.core.Binomial.get(f,g)*i[0][g],s[l][f-g]))}for(var _=1,x=l+1;x>_;){var V=_++;d=verb.core.Vec.sub(d,verb.core.Vec.mul(verb.core.Binomial.get(l,V)*i[V][0],s[l-V][f]));for(var y=verb.core.Vec.zeros1d(v),S=1,E=f+1;E>S;){var P=S++;y=verb.core.Vec.add(y,verb.core.Vec.mul(verb.core.Binomial.get(f,P)*i[V][P],s[l-V][f-P]))}d=verb.core.Vec.sub(d,verb.core.Vec.mul(verb.core.Binomial.get(l,V),y))}s[l].push(verb.core.Vec.mul(1/i[0][0],d))}}return s},verb.eval.Eval.rationalSurfacePoint=function(e,r,n){return verb.eval.Eval.dehomogenize(verb.eval.Eval.surfacePoint(e,r,n))},verb.eval.Eval.rationalCurveDerivatives=function(e,r,n){null==n&&(n=1);for(var t=verb.eval.Eval.curveDerivatives(e,r,n),o=verb.eval.Eval.rational1d(t),a=verb.eval.Eval.weight1d(t),i=[],s=0,v=n+1;v>s;){for(var c=s++,u=o[c],l=1,b=c+1;b>l;){var h=l++;u=verb.core.Vec.sub(u,verb.core.Vec.mul(verb.core.Binomial.get(c,h)*a[h],i[c-h]))}i.push(verb.core.Vec.mul(1/a[0],u))}return i},verb.eval.Eval.rationalCurvePoint=function(e,r){return verb.eval.Eval.dehomogenize(verb.eval.Eval.curvePoint(e,r))},verb.eval.Eval.dehomogenize=function(e){for(var r=e.length,n=[],t=e[r-1],o=e.length-1,a=0;o>a;){var i=a++;n.push(e[i]/t)}return n},verb.eval.Eval.rational1d=function(e){var r=e[0].length-1;return e.map(function(e){return e.slice(0,r)})},verb.eval.Eval.rational2d=function(e){return e.map(verb.eval.Eval.rational1d)},verb.eval.Eval.weight1d=function(e){var r=e[0].length-1;return e.map(function(e){return e[r]})},verb.eval.Eval.weight2d=function(e){return e.map(verb.eval.Eval.weight1d)},verb.eval.Eval.dehomogenize1d=function(e){return e.map(verb.eval.Eval.dehomogenize)},verb.eval.Eval.dehomogenize2d=function(e){return e.map(verb.eval.Eval.dehomogenize1d)},verb.eval.Eval.homogenize1d=function(e,r){var n,t=e.length,o=e[0].length,a=[],i=0,s=[];n=null!=r?r:verb.core.Vec.rep(e.length,1);for(var v=0;t>v;){var c=v++,u=[];s=e[c],i=n[c];for(var l=0;o>l;){var b=l++;u.push(s[b]*i)}u.push(i),a.push(u)}return a},verb.eval.Eval.homogenize2d=function(e,r){var n,t=e.length,o=[];if(null!=r)n=r;else{for(var a=[],i=0;t>i;)i++,a.push(verb.core.Vec.rep(e[0].length,1));n=a}for(var s=0;t>s;){var v=s++;o.push(verb.eval.Eval.homogenize1d(e[v],n[v]))}return o},verb.eval.Eval.surfaceDerivatives=function(e,r,n,t){var o=e.knotsU.length-e.degreeU-2,a=e.knotsV.length-e.degreeV-2;return verb.eval.Eval.surfaceDerivativesGivenNM(o,a,e,r,n,t)},verb.eval.Eval.surfaceDerivativesGivenNM=function(e,r,n,t,o,a){var i=n.degreeU,s=n.degreeV,v=n.controlPoints,c=n.knotsU,u=n.knotsV;if(!verb.eval.Eval.areValidRelations(i,v.length,c.length)||!verb.eval.Eval.areValidRelations(s,v[0].length,u.length))throw"Invalid relations between control points, knot vector, and n";var l,b=v[0][0].length;l=i>a?a:i;var h;h=s>a?a:s;for(var f=verb.core.Vec.zeros3d(l+1,h+1,b),d=verb.eval.Eval.knotSpanGivenN(e,i,t,c),m=verb.eval.Eval.knotSpanGivenN(r,s,o,u),p=verb.eval.Eval.derivativeBasisFunctionsGivenNI(d,t,i,e,c),g=verb.eval.Eval.derivativeBasisFunctionsGivenNI(m,o,s,r,u),_=verb.core.Vec.zeros2d(s+1,b),x=0,V=0,y=l+1;y>V;){for(var S=V++,E=0,P=s+1;P>E;){var M=E++;_[M]=verb.core.Vec.zeros1d(b);for(var k=0,I=i+1;I>k;){var A=k++;_[M]=verb.core.Vec.add(_[M],verb.core.Vec.mul(p[S][A],v[d-i+A][m-s+M]))}}var N=a-S;x=h>N?N:h;for(var C=0,B=x+1;B>C;){var w=C++;f[S][w]=verb.core.Vec.zeros1d(b);for(var L=0,T=s+1;T>L;){var z=L++;f[S][w]=verb.core.Vec.add(f[S][w],verb.core.Vec.mul(g[w][z],_[z]))}}}return f},verb.eval.Eval.surfacePoint=function(e,r,n){var t=e.knotsU.length-e.degreeU-2,o=e.knotsV.length-e.degreeV-2;return verb.eval.Eval.surfacePointGivenNM(t,o,e,r,n)},verb.eval.Eval.surfacePointGivenNM=function(e,r,n,t,o){var a=n.degreeU,i=n.degreeV,s=n.controlPoints,v=n.knotsU,c=n.knotsV;if(!verb.eval.Eval.areValidRelations(a,s.length,v.length)||!verb.eval.Eval.areValidRelations(i,s[0].length,c.length))throw"Invalid relations between control points, knot vector, and n";for(var u=s[0][0].length,l=verb.eval.Eval.knotSpanGivenN(e,a,t,v),b=verb.eval.Eval.knotSpanGivenN(r,i,o,c),h=verb.eval.Eval.basisFunctionsGivenKnotSpanIndex(l,t,a,v),f=verb.eval.Eval.basisFunctionsGivenKnotSpanIndex(b,o,i,c),d=l-a,m=b,p=verb.core.Vec.zeros1d(u),g=verb.core.Vec.zeros1d(u),_=0,x=i+1;x>_;){var V=_++;g=verb.core.Vec.zeros1d(u),m=b-i+V;for(var y=0,S=a+1;S>y;){var E=y++;g=verb.core.Vec.add(g,verb.core.Vec.mul(h[E],s[d+E][m]))}p=verb.core.Vec.add(p,verb.core.Vec.mul(f[V],g))}return p},verb.eval.Eval.curveDerivatives=function(e,r,n){var t=e.knots.length-e.degree-2;return verb.eval.Eval.curveDerivativesGivenN(t,e,r,n)},verb.eval.Eval.curveDerivativesGivenN=function(e,r,n,t){var o=r.degree,a=r.controlPoints,i=r.knots;if(!verb.eval.Eval.areValidRelations(o,a.length,i.length))throw"Invalid relations between control points, knot vector, and n";var s,v=a[0].length;s=o>t?t:o;for(var c=verb.core.Vec.zeros2d(s+1,v),u=verb.eval.Eval.knotSpanGivenN(e,o,n,i),l=verb.eval.Eval.derivativeBasisFunctionsGivenNI(u,n,o,s,i),b=0,h=s+1;h>b;)for(var f=b++,d=0,m=o+1;m>d;){var p=d++;c[f]=verb.core.Vec.add(c[f],verb.core.Vec.mul(l[f][p],a[u-o+p]))}return c},verb.eval.Eval.curvePoint=function(e,r){var n=e.knots.length-e.degree-2;return verb.eval.Eval.curvePointGivenN(n,e,r)},verb.eval.Eval.areValidRelations=function(e,r,n){return 0==r+e+1-n},verb.eval.Eval.curvePointGivenN=function(e,r,n){var t=r.degree,o=r.controlPoints,a=r.knots;if(!verb.eval.Eval.areValidRelations(t,o.length,a.length))throw"Invalid relations between control points, knot Array, and n";for(var i=verb.eval.Eval.knotSpanGivenN(e,t,n,a),s=verb.eval.Eval.basisFunctionsGivenKnotSpanIndex(i,n,t,a),v=verb.core.Vec.zeros1d(o[0].length),c=0,u=t+1;u>c;){var l=c++;v=verb.core.Vec.add(v,verb.core.Vec.mul(s[l],o[i-t+l]))}return v},verb.eval.Eval.derivativeBasisFunctions=function(e,r,n){var t=verb.eval.Eval.knotSpan(r,e,n),o=n.length-1,a=o-r-1;return verb.eval.Eval.derivativeBasisFunctionsGivenNI(t,e,r,a,n)},verb.eval.Eval.derivativeBasisFunctionsGivenNI=function(e,r,n,t,o){var a=verb.core.Vec.zeros2d(n+1,n+1),i=verb.core.Vec.zeros1d(n+1),s=verb.core.Vec.zeros1d(n+1),v=0,c=0;a[0][0]=1;for(var u=1,l=n+1;l>u;){var b=u++;i[b]=r-o[e+1-b],s[b]=o[e+b]-r,v=0;for(var h=0;b>h;){var f=h++;a[b][f]=s[f+1]+i[b-f],c=a[f][b-1]/a[b][f],a[f][b]=v+s[f+1]*c,v=i[b-f]*c}a[b][b]=v}for(var d=verb.core.Vec.zeros2d(t+1,n+1),m=verb.core.Vec.zeros2d(2,n+1),p=0,g=1,_=0,x=0,V=0,y=0,S=0,E=0,P=n+1;P>E;){var M=E++;d[0][M]=a[M][n]}for(var k=0,I=n+1;I>k;){var A=k++;p=0,g=1,m[0][0]=1;for(var N=1,C=t+1;C>N;){var B=N++;_=0,x=A-B,V=n-B,A>=B&&(m[g][0]=m[p][0]/a[V+1][x],_=m[g][0]*a[x][V]),y=x>=-1?1:-x,S=V>=A-1?B-1:n-A;for(var w=y,L=S+1;L>w;){var T=w++;m[g][T]=(m[p][T]-m[p][T-1])/a[V+1][x+T],_+=m[g][T]*a[x+T][V]}V>=A&&(m[g][B]=-m[p][B-1]/a[V+1][A],_+=m[g][B]*a[A][V]),d[B][A]=_;var z=p;p=g,g=z}}for(var D=n,U=1,O=t+1;O>U;){for(var R=U++,$=0,F=n+1;F>$;){var q=$++;d[R][q]*=D}D*=n-R}return d},verb.eval.Eval.basisFunctions=function(e,r,n){var t=verb.eval.Eval.knotSpan(r,e,n);return verb.eval.Eval.basisFunctionsGivenKnotSpanIndex(t,e,r,n)},verb.eval.Eval.basisFunctionsGivenKnotSpanIndex=function(e,r,n,t){var o=verb.core.Vec.zeros1d(n+1),a=verb.core.Vec.zeros1d(n+1),i=verb.core.Vec.zeros1d(n+1),s=0,v=0;o[0]=1;for(var c=1,u=n+1;u>c;){var l=c++;a[l]=r-t[e+1-l],i[l]=t[e+l]-r,s=0;for(var b=0;l>b;){var h=b++;v=o[h]/(i[h+1]+a[l-h]),o[h]=s+i[h+1]*v,s=a[l-h]*v}o[l]=s}return o},verb.eval.Eval.knotSpan=function(e,r,n){return verb.eval.Eval.knotSpanGivenN(n.length-e-2,e,r,n)},verb.eval.Eval.knotSpanGivenN=function(e,r,n,t){if(n>t[e+1]-verb.core.Constants.EPSILON)return e;if(t[r]+verb.core.Constants.EPSILON>n)return r;for(var o=r,a=e+1,i=Math.floor((o+a)/2);t[i]>n||n>=t[i+1];)t[i]>n?a=i:o=i,i=Math.floor((o+a)/2);return i},verb.eval.MarchStepState={__ename__:!0,__constructs__:["OutOfBounds","InsideDomain","AtBoundary","CompleteLoop","CoincidentStartPoint"]},verb.eval.MarchStepState.OutOfBounds=["OutOfBounds",0],verb.eval.MarchStepState.OutOfBounds.toString=$estr,verb.eval.MarchStepState.OutOfBounds.__enum__=verb.eval.MarchStepState,verb.eval.MarchStepState.InsideDomain=["InsideDomain",1],verb.eval.MarchStepState.InsideDomain.toString=$estr,verb.eval.MarchStepState.InsideDomain.__enum__=verb.eval.MarchStepState,verb.eval.MarchStepState.AtBoundary=["AtBoundary",2],verb.eval.MarchStepState.AtBoundary.toString=$estr,verb.eval.MarchStepState.AtBoundary.__enum__=verb.eval.MarchStepState,verb.eval.MarchStepState.CompleteLoop=["CompleteLoop",3],verb.eval.MarchStepState.CompleteLoop.toString=$estr,verb.eval.MarchStepState.CompleteLoop.__enum__=verb.eval.MarchStepState,verb.eval.MarchStepState.CoincidentStartPoint=["CoincidentStartPoint",4],verb.eval.MarchStepState.CoincidentStartPoint.toString=$estr,verb.eval.MarchStepState.CoincidentStartPoint.__enum__=verb.eval.MarchStepState,verb.eval.MarchStep=function(e,r,n,t,o,a,i,s,v){this.stepCount=0,this.step=e,this.olduv0=r,this.olduv1=n,this.uv0=t,this.uv1=o,this.oldpoint=a,this.point=i,this.state=s,this.stepCount=v},verb.eval.MarchStep.__name__=["verb","eval","MarchStep"],verb.eval.MarchStep.outOfBounds=function(){return new verb.eval.MarchStep(null,null,null,null,null,null,null,verb.eval.MarchStepState.OutOfBounds,0)},verb.eval.MarchStep.init=function(e){return new verb.eval.MarchStep(null,null,null,e.uv0,e.uv1,null,e.point,verb.eval.MarchStepState.InsideDomain,0)},verb.eval.ExpIntersect=$hx_exports.eval.ExpIntersect=function(){},verb.eval.ExpIntersect.__name__=["verb","eval","ExpIntersect"],verb.eval.ExpIntersect.outsideDomain=function(e,r){var n=r[0],t=r[1];return verb.core.ArrayExtensions.first(e.knotsU)>n||verb.core.ArrayExtensions.first(e.knotsV)>t||n>verb.core.ArrayExtensions.last(e.knotsU)||t>verb.core.ArrayExtensions.last(e.knotsV)},verb.eval.ExpIntersect.clampToDomain=function(e,r){var n=r[0],t=r[1];return verb.core.ArrayExtensions.first(e.knotsU)>n&&(n=verb.core.ArrayExtensions.first(e.knotsU)),n>verb.core.ArrayExtensions.last(e.knotsU)&&(n=verb.core.ArrayExtensions.last(e.knotsU)),verb.core.ArrayExtensions.first(e.knotsV)>t&&(t=verb.core.ArrayExtensions.first(e.knotsV)),t>verb.core.ArrayExtensions.last(e.knotsV)&&(n=verb.core.ArrayExtensions.last(e.knotsV)),[n,t]},verb.eval.ExpIntersect.clampStep=function(e,r,n){var t=r[0],o=r[1],a=t+n[0];a>verb.core.ArrayExtensions.last(e.knotsU)+verb.core.Constants.EPSILON?n=verb.core.Vec.mul((verb.core.ArrayExtensions.last(e.knotsU)-t)/n[0],n):verb.core.ArrayExtensions.first(e.knotsU)-verb.core.Constants.EPSILON>a&&(n=verb.core.Vec.mul((verb.core.ArrayExtensions.first(e.knotsU)-t)/n[0],n));var i=o+n[1];return i>verb.core.ArrayExtensions.last(e.knotsV)+verb.core.Constants.EPSILON?n=verb.core.Vec.mul((verb.core.ArrayExtensions.last(e.knotsV)-o)/n[1],n):verb.core.ArrayExtensions.first(e.knotsV)-verb.core.Constants.EPSILON>i&&(n=verb.core.Vec.mul((verb.core.ArrayExtensions.first(e.knotsV)-o)/n[1],n)),n},verb.eval.ExpIntersect.march=function(e,r,n,t,o,a){var i=o[t],s=n.uv0,v=n.uv1,c=verb.eval.Eval.rationalSurfaceDerivatives(e,s[0],s[1],1),u=verb.eval.Eval.rationalSurfaceDerivatives(r,v[0],v[1],1),l=c[0][0],b=u[0][0],h=c[1][0],f=c[0][1],d=u[1][0],m=u[0][1],p=verb.core.Vec.cross(h,f),g=verb.core.Vec.cross(d,m),_=verb.core.Vec.normalized(verb.core.Vec.cross(p,g)),x=verb.eval.ExpIntersect.INIT_STEP_LENGTH;if(null!=n.oldpoint){var V=Math.acos(verb.core.Vec.dot(verb.core.Vec.normalized(n.step),_));if(Math.abs(V)<verb.core.Constants.EPSILON)x=verb.eval.ExpIntersect.LINEAR_STEP_LENGTH;else{var y=verb.core.Vec.dist(n.oldpoint,n.point)/Math.acos(verb.core.Vec.dot(verb.core.Vec.normalized(n.step),_)),S=2*Math.acos(1-4*a/y);x=y*Math.tan(S)}}var E=verb.core.Vec.mul(x,_),P=verb.core.Vec.add(n.point,E),M=verb.core.Vec.sub(P,l),k=verb.core.Vec.sub(P,b),I=verb.core.Vec.cross(h,p),A=verb.core.Vec.cross(f,p),N=verb.core.Vec.cross(d,g),C=verb.core.Vec.cross(m,g),B=verb.core.Vec.dot(A,M)/verb.core.Vec.dot(A,h),w=verb.core.Vec.dot(I,M)/verb.core.Vec.dot(I,f),L=verb.core.Vec.dot(C,k)/verb.core.Vec.dot(C,d),T=verb.core.Vec.dot(N,k)/verb.core.Vec.dot(N,m),z=[B,w],D=[L,T],U=verb.core.Vec.add(s,z),O=verb.core.Vec.add(v,D),R=verb.eval.MarchStepState.InsideDomain;if(verb.eval.ExpIntersect.outsideDomain(e,U)){R=verb.eval.MarchStepState.AtBoundary;var $=verb.core.Vec.norm(z);z=verb.eval.ExpIntersect.clampStep(e,s,z),D=verb.core.Vec.mul(verb.core.Vec.norm(z)/$,D)}if(verb.eval.ExpIntersect.outsideDomain(r,O)){R=verb.eval.MarchStepState.AtBoundary;var F=verb.core.Vec.norm(D);D=verb.eval.ExpIntersect.clampStep(r,v,D),z=verb.core.Vec.mul(verb.core.Vec.norm(D)/F,z)}U=verb.core.Vec.add(s,z),O=verb.core.Vec.add(v,D);var q=verb.eval.Intersect.surfacesAtPointWithEstimate(e,r,U,O,a);return n.stepCount>5&&null!=n.olduv0&&10*a>verb.core.Trig.distToSegment(n.point,i.point,q.point)?new verb.eval.MarchStep(E,n.uv0,n.uv1,i.uv0,i.uv1,n.point,i.point,verb.eval.MarchStepState.CompleteLoop,n.stepCount+1):(n.stepCount>5&&verb.eval.ExpIntersect.isCoincidentWithStartPoint(q.point,t,o,10*a)&&(R=verb.eval.MarchStepState.CoincidentStartPoint),new verb.eval.MarchStep(E,n.uv0,n.uv1,q.uv0,q.uv1,n.point,q.point,R,n.stepCount+1))},verb.eval.ExpIntersect.isCoincidentWithStartPoint=function(e,r,n,t){if(0==r)return!1;for(var o=0;r>o;){var a=o++,i=verb.core.Vec.distSquared(n[a].point,n[r].point);if(t>i)return haxe.Log.trace("Coincident start point!",{fileName:"ExpIntersect.hx",lineNumber:257,className:"verb.eval.ExpIntersect",methodName:"isCoincidentWithStartPoint"}),!0}return!1},verb.eval.ExpIntersect.completeMarch=function(e,r,n,t,o){var a=t[n],i=verb.eval.ExpIntersect.march(e,r,verb.eval.MarchStep.init(a),n,t,o);if(i.state==verb.eval.MarchStepState.AtBoundary||i.state==verb.eval.MarchStepState.CoincidentStartPoint)return null;var s=[];for(s.push(a);i.state!=verb.eval.MarchStepState.CoincidentStartPoint&&i.state!=verb.eval.MarchStepState.AtBoundary&&i.state!=verb.eval.MarchStepState.CompleteLoop;){if(s.push(new verb.core.SurfaceSurfaceIntersectionPoint(i.uv0,i.uv1,i.point,-1)),i.state==verb.eval.MarchStepState.CoincidentStartPoint)return null;i=verb.eval.ExpIntersect.march(e,r,i,n,t,o)}return s.push(new verb.core.SurfaceSurfaceIntersectionPoint(i.uv0,i.uv1,i.point,-1)),s},verb.eval.ExpIntersect.surfaces=function(e,r,n){for(var t=[],o=verb.eval.ExpIntersect.intersectBoundaryCurves(e,r,n),a=verb.eval.ExpIntersect.approxInnerCriticalPts(e,r),i=verb.eval.ExpIntersect.refineInnerCriticalPts(e,r,a,n),s=!0,v=0;i.length>v;){var c=i[v];++v;var u=verb.eval.Intersect.curveAndSurface(verb.eval.Make.surfaceIsocurve(e,c.item0[0],!1),r);if(0!=u.length&&s){s=!1;var l=new verb.core.SurfaceSurfaceIntersectionPoint([c.item0[0],u[0].u],u[0].uv,u[0].curvePoint,-1);o.push(l)}}for(var b=0;o.length>b;){haxe.Log.trace("starting at",{fileName:"ExpIntersect.hx",lineNumber:330,className:"verb.eval.ExpIntersect",methodName:"surfaces",customParams:[o[b].point]});var h=verb.eval.ExpIntersect.completeMarch(e,r,b,o,n);if(null!=h){t.push(h);var f=verb.core.ArrayExtensions.last(h);o.splice(b,0,f),haxe.Log.trace("inserting",{fileName:"ExpIntersect.hx",lineNumber:338,className:"verb.eval.ExpIntersect",methodName:"surfaces",customParams:[verb.core.ArrayExtensions.last(h).point]}),b+=2}b++}for(var d=[],m=0;t.length>m;){var p=t[m];++m,d.push(verb.eval.Make.rationalInterpCurve(p.map(function(e){return e.point})))}return d},verb.eval.ExpIntersect.refineInnerCriticalPts=function(e,r,n,t){return n.map(function(n){return verb.eval.ExpIntersect.refineCriticalPt(e,r,n,t)})},verb.eval.ExpIntersect.refineCriticalPt=function(e,r,n,t){var o=function(n){var t=verb.eval.Eval.rationalSurfaceDerivatives(e,n[0],n[1],1),o=verb.eval.Eval.rationalSurfaceDerivatives(r,n[2],n[3],1),a=verb.core.Vec.normalized(verb.core.Vec.cross(t[1][0],t[0][1])),i=verb.core.Vec.normalized(verb.core.Vec.cross(o[1][0],o[0][1])),s=verb.core.Vec.sub(t[0][0],o[0][0]),v=verb.core.Vec.normSquared(s),c=verb.core.Vec.dot(s,i),u=verb.core.Vec.dot(a,i);return v-c*c+1-u*u},a=[n.item0[0],n.item0[1],n.item1[0],n.item1[1]],i=verb.core.Numeric.uncmin(o,a,t),s=i.solution;return new verb.core.Pair([s[0],s[1]],[s[2],s[3]])},verb.eval.ExpIntersect.verifyInnerCriticalPts=function(){return null},verb.eval.ExpIntersect.boundingBoxLeaves=function(e){if(e.indivisible(0))return[e.yield()];var r=e.split();return verb.eval.ExpIntersect.boundingBoxLeaves(r.item0).concat(verb.eval.ExpIntersect.boundingBoxLeaves(r.item1))},verb.eval.ExpIntersect.approxInnerCriticalPts=function(e,r){for(var n=new verb.core.LazySurfaceBoundingBoxTree(e,!1,.6,.6),t=new verb.core.LazySurfaceBoundingBoxTree(r,!1,.6,.6),o=verb.eval.Intersect.boundingBoxTrees(n,t,0),a=4,i=[],s=0;o.length>s;){var v=o[s];++s;for(var c=verb.eval.ExpIntersect.approxSurfaceDelPhiField(v.item0,v.item1,a,a),u=c.delphi,l=c.uvs0,b=c.uvs1,h=1,f=u.length;f>h;)for(var d=h++,m=1,p=u[d].length;p>m;){var g=m++,_=verb.eval.ExpIntersect.approxRotationNumber([u[d][g-1],u[d][g],u[d-1][g],u[d-1][g-1]]);if(0!=_){var x=(l[d][g][1]+l[d][g-1][1])/2,V=(l[d][g][0]+l[d-1][g][0])/2,y=(b[d][g][1]+b[d][g-1][1])/2,S=(b[d][g][0]+b[d-1][g][0])/2;i.push(new verb.core.Pair([x,V],[y,S]))}}}return i},verb.eval.ExpIntersect.approxRotationNumber=function(e){for(var r=0,n=e.length,t=1,o=n+1;o>t;){var a=t++,i=verb.core.Vec.angleBetweenNormalized2d(e[a-1],e[a%n]);r+=Math.abs(i)}return Math.floor(Math.abs(r/(2*Math.PI)))},verb.eval.ExpIntersect.approxSurfaceDelPhiField=function(e,r,n,t){for(var o=verb.eval.ExpIntersect.sampleSurfaceRegular(e,n,t),a=verb.eval.ExpIntersect.sampleSurfaceRegular(r,n,t),i=[],s=0,v=o.uvs.length;v>s;){var c=s++,u=[];i.push(u);for(var l=0,b=o.uvs[c].length;b>l;){for(var h=l++,f=Math.POSITIVE_INFINITY,d=[Math.POSITIVE_INFINITY,Math.POSITIVE_INFINITY],m=0,p=a.uvs.length;p>m;)for(var g=m++,_=0,x=a.uvs[g].length;x>_;){var V=_++,y=verb.core.Vec.distSquared(o.points[c][h],o.points[g][V]);f>y&&(f=y,d=o.uvs[g][V])}u.push(d)}}for(var S=[],E=0,P=i.length;P>E;){var M=E++,k=[];S.push(k);for(var I=0,A=i[M].length;A>I;){var N=I++,C=o.uvs[M][N],B=i[M][N],w=verb.eval.Eval.rationalSurfaceDerivatives(e,C[0],C[1]),L=verb.eval.Eval.rationalSurfaceDerivatives(r,B[0],B[1]),T=verb.core.Vec.normalized(verb.core.Vec.cross(L[1][0],L[0][1])),z=w[1][0],D=w[0][1],U=verb.core.Vec.normalized([verb.core.Vec.dot(T,z),verb.core.Vec.dot(T,D)]);k.push(U)}}return{uvs0:o.uvs,uvs1:i,delphi:S}},verb.eval.ExpIntersect.sampleSurfaceRegular=function(e,r,n){1>r&&(r=1),1>n&&(n=1),e.degreeU,e.degreeV,e.controlPoints;for(var t=e.knotsU,o=e.knotsV,a=.005,i=verb.core.ArrayExtensions.last(t)-verb.core.ArrayExtensions.first(t)-2*a,s=verb.core.ArrayExtensions.last(o)-verb.core.ArrayExtensions.first(o)-2*a,v=verb.core.ArrayExtensions.first(t)+a,c=verb.core.ArrayExtensions.first(o)+a,u=i/r,l=s/n,b=[],h=[],f=0,d=r+1;d>f;){var m=f++,p=[];h.push(p);var g=[];b.push(g);for(var _=v+m*u,x=0,V=n+1;V>x;){var y=x++,S=c+y*l;p.push([_,S]),g.push(verb.eval.Eval.rationalSurfacePoint(e,_,S))}}return{uvs:h,points:b}},verb.eval.ExpIntersect.intersectBoundaryCurves=function(e,r,n){for(var t=verb.eval.Make.surfaceBoundaryCurves(e),o=verb.eval.Make.surfaceBoundaryCurves(r),a=[],i=0,s=t.length;s>i;)for(var v=i++,c=t[v],u=verb.eval.Intersect.curveAndSurface(c,r,n),l=0;u.length>l;){var b=u[l];++l;var h;switch(v){case 0:h=[verb.core.ArrayExtensions.first(e.knotsU),b.u];break;case 1:h=[verb.core.ArrayExtensions.last(e.knotsU),b.u];break;case 2:h=[b.u,verb.core.ArrayExtensions.first(e.knotsV)];break;default:h=[b.u,verb.core.ArrayExtensions.last(e.knotsV)]}var f=verb.core.Vec.dist(b.curvePoint,b.surfacePoint);a.push(new verb.core.SurfaceSurfaceIntersectionPoint(h,b.uv,b.curvePoint,f))}for(var d=0,m=o.length;m>d;)for(var p=d++,g=o[p],_=verb.eval.Intersect.curveAndSurface(g,e,n),x=0;_.length>x;){var V=_[x];++x;var y;switch(p){case 0:y=[verb.core.ArrayExtensions.first(r.knotsU),V.u];break;case 1:y=[verb.core.ArrayExtensions.last(r.knotsU),V.u];break;case 2:y=[V.u,verb.core.ArrayExtensions.first(r.knotsV)];break;default:y=[V.u,verb.core.ArrayExtensions.last(r.knotsV)]}var S=verb.core.Vec.dist(V.curvePoint,V.surfacePoint);a.push(new verb.core.SurfaceSurfaceIntersectionPoint(V.uv,y,V.curvePoint,S))}return verb.core.ArrayExtensions.unique(a,function(e,r){return n>Math.abs(e.uv0[0]-r.uv0[0])&&n>Math.abs(e.uv0[1]-r.uv0[1])})},verb.eval.Intersect=$hx_exports.eval.Intersect=function(){},verb.eval.Intersect.__name__=["verb","eval","Intersect"],verb.eval.Intersect.meshSlices=function(e,r,n,t){for(var o=new verb.core.MeshBoundingBoxTree(e),a=o.boundingBox(),i=a.min[0],s=a.min[1],v=a.max[0],c=a.max[1],u=verb.core.Vec.span(r,n,t),l=[],b=0;u.length>b;){var h=u[b];++b;var f=[[i,s,h],[v,s,h],[v,c,h],[i,c,h]],d=[[0,0],[1,0],[1,1],[0,1]],m=[[0,1,2],[0,2,3]],p=new verb.core.MeshData(m,f,null,d);l.push(verb.eval.Intersect.meshes(e,p,o)),h+=1}return l},verb.eval.Intersect.surfaces=function(e,r,n){var t=verb.eval.Tess.rationalSurfaceAdaptive(e),o=verb.eval.Tess.rationalSurfaceAdaptive(r),a=verb.eval.Intersect.meshes(t,o),i=a.map(function(t){return t.map(function(t){return verb.eval.Intersect.surfacesAtPointWithEstimate(e,r,t.uv0,t.uv1,n)})});return i.map(function(e){return verb.eval.Make.rationalInterpCurve(e.map(function(e){return e.point}),3)})},verb.eval.Intersect.surfacesAtPointWithEstimate=function(e,r,n,t,o){var a,i,s,v,c,u,l,b,h,f,d,m,p,g=5,_=0;do{if(a=verb.eval.Eval.rationalSurfaceDerivatives(e,n[0],n[1],1),i=a[0][0],v=a[1][0],c=a[0][1],s=verb.core.Vec.normalized(verb.core.Vec.cross(v,c)),u=verb.core.Vec.dot(s,i),l=verb.eval.Eval.rationalSurfaceDerivatives(r,t[0],t[1],1),b=l[0][0],f=l[1][0],d=l[0][1],h=verb.core.Vec.normalized(verb.core.Vec.cross(f,d)),m=verb.core.Vec.dot(h,b),p=verb.core.Vec.distSquared(i,b),o*o>p)break;var x=verb.core.Vec.normalized(verb.core.Vec.cross(s,h)),V=verb.core.Vec.dot(x,i),y=verb.eval.Intersect.threePlanes(s,u,h,m,x,V);if(null==y)throw"panic!";var S=verb.core.Vec.sub(y,i),E=verb.core.Vec.sub(y,b),P=verb.core.Vec.cross(v,s),M=verb.core.Vec.cross(c,s),k=verb.core.Vec.cross(f,h),I=verb.core.Vec.cross(d,h),A=verb.core.Vec.dot(M,S)/verb.core.Vec.dot(M,v),N=verb.core.Vec.dot(P,S)/verb.core.Vec.dot(P,c),C=verb.core.Vec.dot(I,E)/verb.core.Vec.dot(I,f),B=verb.core.Vec.dot(k,E)/verb.core.Vec.dot(k,d);n=verb.core.Vec.add([A,N],n),t=verb.core.Vec.add([C,B],t),_++}while(g>_);return new verb.core.SurfaceSurfaceIntersectionPoint(n,t,i,p)},verb.eval.Intersect.meshes=function(e,r,n,t){null==n&&(n=new verb.core.LazyMeshBoundingBoxTree(e)),null==t&&(t=new verb.core.LazyMeshBoundingBoxTree(r));var o=verb.eval.Intersect.boundingBoxTrees(n,t,0),a=verb.core.ArrayExtensions.unique(o.map(function(n){return verb.eval.Intersect.triangles(e,n.item0,r,n.item1)}).filter(function(e){return null!=e}).filter(function(e){return verb.core.Vec.distSquared(e.min.point,e.max.point)>verb.core.Constants.EPSILON}),function(e,r){var n=verb.core.Vec.sub(e.min.uv0,r.min.uv0),t=verb.core.Vec.dot(n,n),o=verb.core.Vec.sub(e.max.uv0,r.max.uv0),a=verb.core.Vec.dot(o,o),i=verb.core.Vec.sub(e.min.uv0,r.max.uv0),s=verb.core.Vec.dot(i,i),v=verb.core.Vec.sub(e.max.uv0,r.min.uv0),c=verb.core.Vec.dot(v,v);return verb.core.Constants.EPSILON>t&&verb.core.Constants.EPSILON>a||verb.core.Constants.EPSILON>s&&verb.core.Constants.EPSILON>c});return verb.eval.Intersect.makeMeshIntersectionPolylines(a)},verb.eval.Intersect.makeMeshIntersectionPolylines=function(e){if(0==e.length)return[];for(var r=0;e.length>r;){var n=e[r];++r,n.max.opp=n.min,n.min.opp=n.max}for(var t=verb.eval.Intersect.kdTreeFromSegments(e),o=[],a=0;e.length>a;){var i=e[a];++a,o.push(i.min),o.push(i.max)}for(var s=0;o.length>s;){var v=o[s];if(++s,null==v.adj){var c=verb.eval.Intersect.lookupAdjacentSegment(v,t,e.length);null!=c&&null==c.adj&&(v.adj=c,c.adj=v)}}var u=o.filter(function(e){return null==e.adj});0==u.length&&(u=o);for(var l=[],b=0,h=!1;0!=u.length;){var f=u.pop();if(!f.visited){for(var d=[],m=f;null!=m&&!m.visited&&(m.visited=!0,m.opp.visited=!0,d.push(m),b+=2,m=m.opp.adj,m!=f););d.length>0&&(d.push(d[d.length-1].opp),l.push(d))}if(0==u.length&&o.length>0&&(h||o.length>b)){h=!0;var p=o.pop();u.push(p)}}return l},verb.eval.Intersect.kdTreeFromSegments=function(e){for(var r=[],n=0;e.length>n;){var t=e[n];++n,r.push(new verb.core.KdPoint(t.min.point,t.min)),r.push(new verb.core.KdPoint(t.max.point,t.max))}return new verb.core.KdTree(r,verb.core.Vec.distSquared)},verb.eval.Intersect.lookupAdjacentSegment=function(e,r,n){var t=r.nearest(e.point,n,verb.core.Constants.EPSILON).filter(function(r){return e!=r.item0.obj}).map(function(e){return e.item0.obj});return 1==t.length?t[0]:null},verb.eval.Intersect.curveAndSurface=function(e,r,n,t,o){null==n&&(n=.001),t=null!=t?t:new verb.core.LazyCurveBoundingBoxTree(e),o=null!=o?o:new verb.core.LazySurfaceBoundingBoxTree(r);var a=verb.eval.Intersect.boundingBoxTrees(t,o,n);return verb.core.ArrayExtensions.unique(a.map(function(e){var r=e.item0,t=e.item1,o=verb.core.ArrayExtensions.first(r.knots),a=verb.core.ArrayExtensions.last(r.knots),i=(o+a)/2,s=verb.core.ArrayExtensions.first(t.knotsU),v=verb.core.ArrayExtensions.last(t.knotsU),c=verb.core.ArrayExtensions.first(t.knotsV),u=verb.core.ArrayExtensions.last(t.knotsV),l=[(s+v)/2,(c+u)/2];return verb.eval.Intersect.curveAndSurfaceWithEstimate(r,t,[i].concat(l),n)}).filter(function(e){return n*n>verb.core.Vec.distSquared(e.curvePoint,e.surfacePoint)}),function(e,r){return.5*n>Math.abs(e.u-r.u)})},verb.eval.Intersect.curveAndSurfaceWithEstimate=function(e,r,n,t){null==t&&(t=.001);var o=function(n){var t=verb.eval.Eval.rationalCurvePoint(e,n[0]),o=verb.eval.Eval.rationalSurfacePoint(r,n[1],n[2]),a=verb.core.Vec.sub(t,o);return verb.core.Vec.dot(a,a)},a=function(n){var t=verb.eval.Eval.rationalCurveDerivatives(e,n[0],1),o=verb.eval.Eval.rationalSurfaceDerivatives(r,n[1],n[2],1),a=verb.core.Vec.sub(o[0][0],t[0]),i=verb.core.Vec.mul(-1,t[1]),s=o[1][0],v=o[0][1];return[2*verb.core.Vec.dot(i,a),2*verb.core.Vec.dot(s,a),2*verb.core.Vec.dot(v,a)]},i=verb.core.Numeric.uncmin(o,n,t*t,a),s=i.solution;return new verb.core.CurveSurfaceIntersection(s[0],[s[1],s[2]],verb.eval.Eval.rationalCurvePoint(e,s[0]),verb.eval.Eval.rationalSurfacePoint(r,s[1],s[2]))},verb.eval.Intersect.polylineAndMesh=function(e,r,n){for(var t=verb.eval.Intersect.boundingBoxTrees(new verb.core.LazyPolylineBoundingBoxTree(e),new verb.core.LazyMeshBoundingBoxTree(r),n),o=[],a=0;t.length>a;){var i=t[a];++a;var s=i.item0,v=i.item1,c=verb.eval.Intersect.segmentWithTriangle(e.points[s],e.points[s+1],r.points,r.faces[v]);if(null!=c){var u=c.point,l=verb.core.Vec.lerp(c.p,[e.params[s]],[e.params[s+1]])[0],b=verb.core.Mesh.triangleUVFromPoint(r,v,u);o.push(new verb.core.PolylineMeshIntersection(u,l,b,s,v))}}return o},verb.eval.Intersect.boundingBoxTrees=function(e,r,n){null==n&&(n=1e-9);var t=[],o=[];t.push(e),o.push(r);for(var a=[];t.length>0;){var i=t.pop(),s=o.pop();if(!i.empty()&&!s.empty()&&i.boundingBox().intersects(s.boundingBox(),n)){var v=i.indivisible(n),c=s.indivisible(n);if(v&&c)a.push(new verb.core.Pair(i.yield(),s.yield()));else if(!v||c)if(v||!c){var u=i.split(),l=s.split();t.push(u.item1),o.push(l.item1),t.push(u.item1),o.push(l.item0),t.push(u.item0),o.push(l.item1),t.push(u.item0),o.push(l.item0)}else{var b=i.split();t.push(b.item1),o.push(s),t.push(b.item0),o.push(s)}else{var h=s.split();t.push(i),o.push(h.item1),t.push(i),o.push(h.item0)}}}return a},verb.eval.Intersect.curves=function(e,r,n){var t=verb.eval.Intersect.boundingBoxTrees(new verb.core.LazyCurveBoundingBoxTree(e),new verb.core.LazyCurveBoundingBoxTree(r),0);return verb.core.ArrayExtensions.unique(t.map(function(t){return verb.eval.Intersect.curvesWithEstimate(e,r,verb.core.ArrayExtensions.first(t.item0.knots),verb.core.ArrayExtensions.first(t.item1.knots),n)}).filter(function(e){return n>verb.core.Vec.distSquared(e.point0,e.point1)}),function(e,r){return 5*n>Math.abs(e.u0-r.u0)})},verb.eval.Intersect.curvesWithEstimate=function(e,r,n,t,o){var a=function(n){var t=verb.eval.Eval.rationalCurvePoint(e,n[0]),o=verb.eval.Eval.rationalCurvePoint(r,n[1]),a=verb.core.Vec.sub(t,o);return verb.core.Vec.dot(a,a)},i=function(n){var t=verb.eval.Eval.rationalCurveDerivatives(e,n[0],1),o=verb.eval.Eval.rationalCurveDerivatives(r,n[1],1),a=verb.core.Vec.sub(t[0],o[0]),i=t[1],s=verb.core.Vec.mul(-1,o[1]);return[2*verb.core.Vec.dot(i,a),2*verb.core.Vec.dot(s,a)]},s=verb.core.Numeric.uncmin(a,[n,t],o*o,i),v=s.solution[0],c=s.solution[1],u=verb.eval.Eval.rationalCurvePoint(e,v),l=verb.eval.Eval.rationalCurvePoint(r,c);return new verb.core.CurveCurveIntersection(u,l,v,c)},verb.eval.Intersect.triangles=function(e,r,n,t){var o=e.faces[r],a=n.faces[t],i=verb.core.Mesh.getTriangleNorm(e.points,o),s=verb.core.Mesh.getTriangleNorm(n.points,a),v=e.points[o[0]],c=n.points[a[0]],u=verb.eval.Intersect.planes(v,i,c,s);if(null==u)return null;var l=verb.eval.Intersect.clipRayInCoplanarTriangle(u,e,r);if(null==l)return null;var b=verb.eval.Intersect.clipRayInCoplanarTriangle(u,n,t);if(null==b)return null;var h=verb.eval.Intersect.mergeTriangleClipIntervals(l,b,e,r,n,t);return null==h?null:new verb.core.Interval(new verb.core.MeshIntersectionPoint(h.min.uv0,h.min.uv1,h.min.point,r,t),new verb.core.MeshIntersectionPoint(h.max.uv0,h.max.uv1,h.max.point,r,t))},verb.eval.Intersect.clipRayInCoplanarTriangle=function(e,r,n){for(var t=r.faces[n],o=[r.points[t[0]],r.points[t[1]],r.points[t[2]]],a=[r.uvs[t[0]],r.uvs[t[1]],r.uvs[t[2]]],i=[verb.core.Vec.sub(a[1],a[0]),verb.core.Vec.sub(a[2],a[1]),verb.core.Vec.sub(a[0],a[2])],s=[verb.core.Vec.sub(o[1],o[0]),verb.core.Vec.sub(o[2],o[1]),verb.core.Vec.sub(o[0],o[2])],v=s.map(verb.core.Vec.normalized),c=s.map(verb.core.Vec.norm),u=null,l=null,b=0;3>b;){var h=b++,f=o[h],d=v[h],m=verb.eval.Intersect.rays(f,d,e.origin,e.dir);if(null!=m){var p=m.u0,g=m.u1;-verb.core.Constants.EPSILON>p||p>c[h]+verb.core.Constants.EPSILON||((null==u||u.u>g)&&(u=new verb.core.CurveTriPoint(g,verb.core.Vec.onRay(e.origin,e.dir,g),verb.core.Vec.onRay(a[h],i[h],p/c[h]))),(null==l||g>l.u)&&(l=new verb.core.CurveTriPoint(g,verb.core.Vec.onRay(e.origin,e.dir,g),verb.core.Vec.onRay(a[h],i[h],p/c[h]))))}}return null==l||null==u?null:new verb.core.Interval(u,l)},verb.eval.Intersect.mergeTriangleClipIntervals=function(e,r,n,t,o,a){if(r.min.u>e.max.u+verb.core.Constants.EPSILON||e.min.u>r.max.u+verb.core.Constants.EPSILON)return null;var i;i=e.min.u>r.min.u?new verb.core.Pair(e.min,0):new verb.core.Pair(r.min,1);var s;s=e.max.u<r.max.u?new verb.core.Pair(e.max,0):new verb.core.Pair(r.max,1);var v=new verb.core.Interval(new verb.core.MeshIntersectionPoint(null,null,i.item0.point,t,a),new verb.core.MeshIntersectionPoint(null,null,s.item0.point,t,a));return 0==i.item1?(v.min.uv0=i.item0.uv,v.min.uv1=verb.core.Mesh.triangleUVFromPoint(o,a,i.item0.point)):(v.min.uv0=verb.core.Mesh.triangleUVFromPoint(n,t,i.item0.point),v.min.uv1=i.item0.uv),0==s.item1?(v.max.uv0=s.item0.uv,v.max.uv1=verb.core.Mesh.triangleUVFromPoint(o,a,s.item0.point)):(v.max.uv0=verb.core.Mesh.triangleUVFromPoint(n,t,s.item0.point),v.max.uv1=s.item0.uv),v},verb.eval.Intersect.planes=function(e,r,n,t){var o=verb.core.Vec.cross(r,t);if(verb.core.Vec.dot(o,o)<verb.core.Constants.EPSILON)return null;var a=0,i=Math.abs(o[0]),s=Math.abs(o[1]),v=Math.abs(o[2]);s>i&&(a=1,i=s),v>i&&(a=2,i=v);var c,u,l,b;0==a?(c=r[1],u=r[2],l=t[1],b=t[2]):1==a?(c=r[0],u=r[2],l=t[0],b=t[2]):(c=r[0],u=r[1],l=t[0],b=t[1]);var h,f=-verb.core.Vec.dot(e,r),d=-verb.core.Vec.dot(n,t),m=c*b-u*l,p=(u*d-f*b)/m,g=(f*l-c*d)/m;return h=0==a?[0,p,g]:1==a?[p,0,g]:[p,g,0],new verb.core.Ray(h,verb.core.Vec.normalized(o))},verb.eval.Intersect.threePlanes=function(e,r,n,t,o,a){var i=verb.core.Vec.cross(n,o),s=verb.core.Vec.dot(e,i);if(Math.abs(s)<verb.core.Constants.EPSILON)return null;var v=verb.core.Vec.sub(verb.core.Vec.mul(a,n),verb.core.Vec.mul(t,o)),c=verb.core.Vec.add(verb.core.Vec.mul(r,i),verb.core.Vec.cross(e,v));
return verb.core.Vec.mul(1/s,c)},verb.eval.Intersect.polylines=function(e,r,n){for(var t=verb.eval.Intersect.boundingBoxTrees(new verb.core.LazyPolylineBoundingBoxTree(e),new verb.core.LazyPolylineBoundingBoxTree(r),n),o=[],a=0;t.length>a;){var i=t[a];++a;var s=i.item0,v=i.item1,c=verb.eval.Intersect.segments(e.points[s],e.points[s+1],r.points[v],r.points[v+1],n);null!=c&&(c.u0=verb.core.Vec.lerp(c.u0,[e.params[s]],[e.params[s+1]])[0],c.u1=verb.core.Vec.lerp(c.u1,[r.params[v]],[r.params[v+1]])[0],o.push(c))}return o},verb.eval.Intersect.segments=function(e,r,n,t,o){var a=verb.core.Vec.sub(r,e),i=Math.sqrt(verb.core.Vec.dot(a,a)),s=verb.core.Vec.mul(1/i,a),v=verb.core.Vec.sub(t,n),c=Math.sqrt(verb.core.Vec.dot(v,v)),u=verb.core.Vec.mul(1/c,v),l=verb.eval.Intersect.rays(e,s,n,u);if(null!=l){var b=Math.min(Math.max(0,l.u0/i),1),h=Math.min(Math.max(0,l.u1/c),1),f=verb.core.Vec.onRay(e,a,b),d=verb.core.Vec.onRay(n,v,h),m=verb.core.Vec.distSquared(f,d);if(o*o>m)return new verb.core.CurveCurveIntersection(f,d,b,h)}return null},verb.eval.Intersect.rays=function(e,r,n,t){var o=verb.core.Vec.dot(r,t),a=verb.core.Vec.dot(r,n),i=verb.core.Vec.dot(r,e),s=verb.core.Vec.dot(t,n),v=verb.core.Vec.dot(t,e),c=verb.core.Vec.dot(r,r),u=verb.core.Vec.dot(t,t),l=c*u-o*o;if(Math.abs(l)<verb.core.Constants.EPSILON)return null;var b=o*(a-i)-c*(s-v),h=b/l,f=(a-i+h*o)/c,d=verb.core.Vec.onRay(e,r,f),m=verb.core.Vec.onRay(n,t,h);return new verb.core.CurveCurveIntersection(d,m,f,h)},verb.eval.Intersect.segmentWithTriangle=function(e,r,n,t){var o=n[t[0]],a=n[t[1]],i=n[t[2]],s=verb.core.Vec.sub(a,o),v=verb.core.Vec.sub(i,o),c=verb.core.Vec.cross(s,v),u=verb.core.Vec.sub(r,e),l=verb.core.Vec.sub(e,o),b=-verb.core.Vec.dot(c,l),h=verb.core.Vec.dot(c,u);if(Math.abs(h)<verb.core.Constants.EPSILON)return null;var f=b/h;if(0>f||f>1)return null;var d=verb.core.Vec.add(e,verb.core.Vec.mul(f,u)),m=verb.core.Vec.dot(s,v),p=verb.core.Vec.dot(s,s),g=verb.core.Vec.dot(v,v),_=verb.core.Vec.sub(d,o),x=verb.core.Vec.dot(_,s),V=verb.core.Vec.dot(_,v),y=m*m-p*g;if(Math.abs(y)<verb.core.Constants.EPSILON)return null;var S=(m*V-g*x)/y,E=(m*x-p*V)/y;return S>1+verb.core.Constants.EPSILON||E>1+verb.core.Constants.EPSILON||-verb.core.Constants.EPSILON>E||-verb.core.Constants.EPSILON>S||S+E>1+verb.core.Constants.EPSILON?null:new verb.core.TriSegmentIntersection(d,S,E,f)},verb.eval.Intersect.segmentAndPlane=function(e,r,n,t){var o=verb.core.Vec.dot(t,verb.core.Vec.sub(r,e));if(Math.abs(o)<verb.core.Constants.EPSILON)return null;var a=verb.core.Vec.dot(t,verb.core.Vec.sub(n,e)),i=a/o;return i>1+verb.core.Constants.EPSILON||-verb.core.Constants.EPSILON>i?null:{p:i}},verb.eval.Make=$hx_exports.eval.Make=function(){},verb.eval.Make.__name__=["verb","eval","Make"],verb.eval.Make.rationalTranslationalSurface=function(e,r){for(var n=verb.eval.Eval.rationalCurvePoint(r,verb.core.ArrayExtensions.first(r.knots)),t=verb.core.ArrayExtensions.first(r.knots),o=verb.core.ArrayExtensions.last(r.knots),a=2*r.controlPoints.length,i=(o-t)/(a-1),s=[],v=0;a>v;){var c=v++,u=verb.core.Vec.sub(verb.eval.Eval.rationalCurvePoint(r,t+c*i),n),l=verb.eval.Modify.rationalCurveTransform(e,[[1,0,0,u[0]],[0,1,0,u[1]],[0,0,1,u[2]],[0,0,0,1]]);s.push(l)}return verb.eval.Make.loftedSurface(s)},verb.eval.Make.surfaceBoundaryCurves=function(e){var r=verb.eval.Make.surfaceIsocurve(e,verb.core.ArrayExtensions.first(e.knotsU),!1),n=verb.eval.Make.surfaceIsocurve(e,verb.core.ArrayExtensions.last(e.knotsU),!1),t=verb.eval.Make.surfaceIsocurve(e,verb.core.ArrayExtensions.first(e.knotsV),!0),o=verb.eval.Make.surfaceIsocurve(e,verb.core.ArrayExtensions.last(e.knotsV),!0);return[r,n,t,o]},verb.eval.Make.surfaceIsocurve=function(e,r,n){null==n&&(n=!1);var t;t=n?e.knotsV:e.knotsU;var o;o=n?e.degreeV:e.degreeU;for(var a=verb.eval.Analyze.knotMultiplicities(t),i=-1,s=0,v=a.length;v>s;){var c=s++;if(Math.abs(r-a[c].knot)<verb.core.Constants.EPSILON){i=c;break}}var u=o+1;i>=0&&(u-=a[i].mult);var l;l=u>0?verb.eval.Modify.surfaceKnotRefine(e,verb.core.Vec.rep(u,r),n):e;var b=verb.eval.Eval.knotSpan(o,r,t);return Math.abs(r-verb.core.ArrayExtensions.first(t))<verb.core.Constants.EPSILON?b=0:Math.abs(r-verb.core.ArrayExtensions.last(t))<verb.core.Constants.EPSILON&&(b=(n?l.controlPoints[0].length:l.controlPoints.length)-1),n?new verb.core.NurbsCurveData(l.degreeU,l.knotsU,function(){for(var e,r=[],n=0,t=l.controlPoints;t.length>n;){var o=t[n];++n,r.push(o[b])}return e=r}(this)):new verb.core.NurbsCurveData(l.degreeV,l.knotsV,l.controlPoints[b])},verb.eval.Make.loftedSurface=function(e,r){e=verb.eval.Modify.unifyCurveKnotVectors(e);var n=e[0].degree;null==r&&(r=3),r>e.length-1&&(r=e.length-1);for(var t=e[0].knots,o=[],a=[],i=0,s=e[0].controlPoints.length;s>i;){var v=[i++],c=e.map(function(e){return function(r){return r.controlPoints[e[0]]}}(v)),u=verb.eval.Make.rationalInterpCurve(c,r,!0);a.push(u.controlPoints),o=u.knots}return new verb.core.NurbsSurfaceData(n,r,t,o,a)},verb.eval.Make.clonedCurve=function(e){return new verb.core.NurbsCurveData(e.degree,e.knots.slice(),e.controlPoints.map(function(e){return e.slice()}))},verb.eval.Make.rationalBezierCurve=function(e,r){for(var n=e.length-1,t=[],o=0,a=n+1;a>o;)o++,t.push(0);for(var i=0,s=n+1;s>i;)i++,t.push(1);return null==r&&(r=verb.core.Vec.rep(e.length,1)),new verb.core.NurbsCurveData(n,t,verb.eval.Eval.homogenize1d(e,r))},verb.eval.Make.fourPointSurface=function(e,r,n,t,o){null==o&&(o=3);for(var a=o,i=[],s=0,v=o+1;v>s;){for(var c=s++,u=[],l=0,b=o+1;b>l;){var h=l++,f=1-c/a,d=verb.core.Vec.lerp(f,e,r),m=verb.core.Vec.lerp(f,t,n),p=verb.core.Vec.lerp(1-h/a,d,m);p.push(1),u.push(p)}i.push(u)}var g=verb.core.Vec.rep(o+1,0),_=verb.core.Vec.rep(o+1,1);return new verb.core.NurbsSurfaceData(o,o,g.concat(_),g.concat(_),i)},verb.eval.Make.ellipseArc=function(e,r,n,t,o){var a=verb.core.Vec.norm(r),i=verb.core.Vec.norm(n);r=verb.core.Vec.normalized(r),n=verb.core.Vec.normalized(n),t>o&&(o=2*Math.PI+t);var s=o-t,v=0;v=Math.PI/2>=s?1:Math.PI>=s?2:3*Math.PI/2>=s?3:4;var c=s/v,u=Math.cos(c/2),l=verb.core.Vec.add(e,verb.core.Vec.add(verb.core.Vec.mul(a*Math.cos(t),r),verb.core.Vec.mul(i*Math.sin(t),n))),b=verb.core.Vec.sub(verb.core.Vec.mul(Math.cos(t),n),verb.core.Vec.mul(Math.sin(t),r)),h=[],f=verb.core.Vec.zeros1d(2*v+3),d=0,m=t,p=verb.core.Vec.zeros1d(2*v);h[0]=l,p[0]=1;for(var g=1,_=v+1;_>g;){var x=g++;m+=c;var V=verb.core.Vec.add(e,verb.core.Vec.add(verb.core.Vec.mul(a*Math.cos(m),r),verb.core.Vec.mul(i*Math.sin(m),n)));p[d+2]=1,h[d+2]=V;var y=verb.core.Vec.sub(verb.core.Vec.mul(Math.cos(m),n),verb.core.Vec.mul(Math.sin(m),r)),S=verb.eval.Intersect.rays(l,verb.core.Vec.mul(1/verb.core.Vec.norm(b),b),V,verb.core.Vec.mul(1/verb.core.Vec.norm(y),y)),E=verb.core.Vec.add(l,verb.core.Vec.mul(S.u0,b));p[d+1]=u,h[d+1]=E,d+=2,v>x&&(l=V,b=y)}for(var P=2*v+1,M=0;3>M;){var k=M++;f[k]=0,f[k+P]=1}switch(v){case 2:f[3]=f[4]=.5;break;case 3:f[3]=f[4]=.3333333333333333,f[5]=f[6]=.6666666666666666;break;case 4:f[3]=f[4]=.25,f[5]=f[6]=.5,f[7]=f[8]=.75}return new verb.core.NurbsCurveData(2,f,verb.eval.Eval.homogenize1d(h,p))},verb.eval.Make.arc=function(e,r,n,t,o,a){return verb.eval.Make.ellipseArc(e,verb.core.Vec.mul(t,verb.core.Vec.normalized(r)),verb.core.Vec.mul(t,verb.core.Vec.normalized(n)),o,a)},verb.eval.Make.polyline=function(e){for(var r=[0,0],n=0,t=0,o=e.length-1;o>t;){var a=t++;n+=verb.core.Vec.dist(e[a],e[a+1]),r.push(n)}r.push(n),r=verb.core.Vec.mul(1/n,r);for(var i,s=[],v=0,c=e.length;c>v;)v++,s.push(1);return i=s,new verb.core.NurbsCurveData(1,r,verb.eval.Eval.homogenize1d(e.slice(0),i))},verb.eval.Make.extrudedSurface=function(e,r,n){for(var t=[[],[],[]],o=[[],[],[]],a=verb.eval.Eval.dehomogenize1d(n.controlPoints),i=verb.eval.Eval.weight1d(n.controlPoints),s=verb.core.Vec.mul(r,e),v=verb.core.Vec.mul(.5*r,e),c=0,u=a.length;u>c;){var l=c++;t[2][l]=a[l],t[1][l]=verb.core.Vec.add(v,a[l]),t[0][l]=verb.core.Vec.add(s,a[l]),o[0][l]=i[l],o[1][l]=i[l],o[2][l]=i[l]}return new verb.core.NurbsSurfaceData(2,n.degree,[0,0,0,1,1,1],n.knots,verb.eval.Eval.homogenize2d(t,o))},verb.eval.Make.cylindricalSurface=function(e,r,n,t,o){var a=verb.core.Vec.cross(e,r);2*Math.PI;var i=verb.eval.Make.arc(n,r,a,o,0,2*Math.PI);return verb.eval.Make.extrudedSurface(e,t,i)},verb.eval.Make.revolvedSurface=function(e,r,n,t){var o,a,i=verb.eval.Eval.dehomogenize1d(e.controlPoints),s=verb.eval.Eval.weight1d(e.controlPoints);Math.PI/2>=t?(o=1,a=verb.core.Vec.zeros1d(6+2*(o-1))):Math.PI>=t?(o=2,a=verb.core.Vec.zeros1d(6+2*(o-1)),a[3]=a[4]=.5):3*Math.PI/2>=t?(o=3,a=verb.core.Vec.zeros1d(6+2*(o-1)),a[3]=a[4]=.3333333333333333,a[5]=a[6]=.6666666666666666):(o=4,a=verb.core.Vec.zeros1d(6+2*(o-1)),a[3]=a[4]=.25,a[5]=a[6]=.5,a[7]=a[8]=.75);for(var v=t/o,c=3+2*(o-1),u=0;3>u;){var l=u++;a[l]=0,a[c+l]=1}for(var b=Math.cos(v/2),h=0,f=verb.core.Vec.zeros1d(o+1),d=verb.core.Vec.zeros1d(o+1),m=verb.core.Vec.zeros3d(2*o+1,i.length,3),p=verb.core.Vec.zeros2d(2*o+1,i.length),g=1,_=o+1;_>g;){var x=g++;h+=v,d[x]=Math.cos(h),f[x]=Math.sin(h)}for(var V=0,y=i.length;y>V;){var S=V++,E=verb.core.Trig.rayClosestPoint(i[S],r,n),P=verb.core.Vec.sub(i[S],E),M=verb.core.Vec.norm(P),k=verb.core.Vec.cross(n,P);M>verb.core.Constants.EPSILON&&(P=verb.core.Vec.mul(1/M,P),k=verb.core.Vec.mul(1/M,k)),m[0][S]=i[S];var I=i[S];p[0][S]=s[S];for(var A=k,N=0,C=1,B=o+1;B>C;){var w,L=C++;w=0==M?E:verb.core.Vec.add(E,verb.core.Vec.add(verb.core.Vec.mul(M*d[L],P),verb.core.Vec.mul(M*f[L],k))),m[N+2][S]=w,p[N+2][S]=s[S];var T=verb.core.Vec.sub(verb.core.Vec.mul(d[L],k),verb.core.Vec.mul(f[L],P));if(0==M)m[N+1][S]=E;else{var z=verb.eval.Intersect.rays(I,verb.core.Vec.mul(1/verb.core.Vec.norm(A),A),w,verb.core.Vec.mul(1/verb.core.Vec.norm(T),T)),D=verb.core.Vec.add(I,verb.core.Vec.mul(z.u0,A));m[N+1][S]=D}p[N+1][S]=b*s[S],N+=2,o>L&&(I=w,A=T)}}return new verb.core.NurbsSurfaceData(2,e.degree,a,e.knots,verb.eval.Eval.homogenize2d(m,p))},verb.eval.Make.sphericalSurface=function(e,r,n,t){var o=verb.eval.Make.arc(e,verb.core.Vec.mul(-1,r),n,t,0,Math.PI);return verb.eval.Make.revolvedSurface(o,e,r,2*Math.PI)},verb.eval.Make.conicalSurface=function(e,r,n,t,o){var a=2*Math.PI,i=1,s=[verb.core.Vec.add(n,verb.core.Vec.mul(t,e)),verb.core.Vec.add(n,verb.core.Vec.mul(o,r))],v=[0,0,1,1],c=[1,1],u=new verb.core.NurbsCurveData(i,v,verb.eval.Eval.homogenize1d(s,c));return verb.eval.Make.revolvedSurface(u,n,e,a)},verb.eval.Make.rationalInterpCurve=function(e,r,n,t,o){if(null==n&&(n=!1),null==r&&(r=3),r+1>e.length)throw"You need to supply at least degree + 1 points! You only supplied "+e.length+" points.";for(var a=[0],i=1,s=e.length;s>i;){var v=i++,c=verb.core.Vec.norm(verb.core.Vec.sub(e[v],e[v-1])),u=a[a.length-1];a.push(u+c)}for(var l=a[a.length-1],b=0,h=a.length;h>b;){var f=b++;a[f]=a[f]/l}var d,m=verb.core.Vec.rep(r+1,0),p=null!=t&&null!=o;d=p?0:1;var g;g=p?a.length-r+1:a.length-r;for(var _=d;g>_;){for(var x=_++,V=0,y=0;r>y;){var S=y++;V+=a[x+S]}m.push(1/r*V)}var E,P=m.concat(verb.core.Vec.rep(r+1,1)),M=[];E=p?e.length+1:e.length-1;var k;k=p?1:0;var I;I=p?e.length-(r-1):e.length-(r+1);for(var A=0;a.length>A;){var N=a[A];++A;var C=verb.eval.Eval.knotSpanGivenN(E,r,N,P),B=verb.eval.Eval.basisFunctionsGivenKnotSpanIndex(C,N,r,P),w=C-r,L=verb.core.Vec.zeros1d(w),T=verb.core.Vec.zeros1d(I-w);M.push(L.concat(B).concat(T))}if(p){var z=M[0].length-2,D=[-1,1].concat(verb.core.Vec.zeros1d(z)),U=verb.core.Vec.zeros1d(z).concat([-1,1]);verb.core.ArrayExtensions.spliceAndInsert(M,1,0,D),verb.core.ArrayExtensions.spliceAndInsert(M,M.length-1,0,U)}for(var O=e[0].length,R=[],$=(1-P[P.length-r-2])/r,F=P[r+1]/r,q=0;O>q;){var j,K=[q++];if(p){j=[e[0][K[0]]],j.push(F*t[K[0]]);for(var G=1,W=e.length-1;W>G;){var H=G++;j.push(e[H][K[0]])}j.push($*o[K[0]]),j.push(verb.core.ArrayExtensions.last(e)[K[0]])}else j=e.map(function(e){return function(r){return r[e[0]]}}(K));var Y=verb.core.Mat.solve(M,j);R.push(Y)}var Q=verb.core.Mat.transpose(R);if(!n){var Z=verb.core.Vec.rep(Q.length,1);Q=verb.eval.Eval.homogenize1d(Q,Z)}return new verb.core.NurbsCurveData(r,P,Q)},verb.eval.Modify=$hx_exports.eval.Modify=function(){},verb.eval.Modify.__name__=["verb","eval","Modify"],verb.eval.Modify.curveReverse=function(e){return new verb.core.NurbsCurveData(e.degree,verb.eval.Modify.knotsReverse(e.knots),verb.core.ArrayExtensions.reversed(e.controlPoints))},verb.eval.Modify.surfaceReverse=function(e,r){return null==r&&(r=!1),r?new verb.core.NurbsSurfaceData(e.degreeU,e.degreeV,e.knotsU,verb.eval.Modify.knotsReverse(e.knotsV),function(){for(var r,n=[],t=0,o=e.controlPoints;o.length>t;){var a=o[t];++t,n.push(verb.core.ArrayExtensions.reversed(a))}return r=n}(this)):new verb.core.NurbsSurfaceData(e.degreeU,e.degreeV,verb.eval.Modify.knotsReverse(e.knotsU),e.knotsV,verb.core.ArrayExtensions.reversed(e.controlPoints))},verb.eval.Modify.knotsReverse=function(e){var r=verb.core.ArrayExtensions.first(e);verb.core.ArrayExtensions.last(e);for(var n=[r],t=e.length,o=1;t>o;){var a=o++;n.push(n[a-1]+(e[t-a]-e[t-a-1]))}return n},verb.eval.Modify.unifyCurveKnotVectors=function(e){e=e.map(verb.eval.Make.clonedCurve);for(var r=Lambda.fold(e,function(e,r){return verb.eval.Modify.imax(e.degree,r)},0),n=0,t=e.length;t>n;){var o=n++;r>e[o].degree&&(e[o]=verb.eval.Modify.curveElevateDegree(e[o],r))}for(var a,i=[],s=0;e.length>s;){var v=e[s];++s,i.push(new verb.core.Interval(verb.core.ArrayExtensions.first(v.knots),verb.core.ArrayExtensions.last(v.knots)))}a=i;for(var c=0,u=e.length;u>c;){var l=c++,b=[a[l].min];e[l].knots=e[l].knots.map(function(e){return function(r){return r-e[0]}}(b))}for(var h=a.map(function(e){return e.max-e.min}),f=Lambda.fold(h,function(e,r){return Math.max(e,r)},0),d=0,m=e.length;m>d;){var p=d++,g=[f/h[p]];e[p].knots=e[p].knots.map(function(e){return function(r){return r*e[0]}}(g))}for(var _=Lambda.fold(e,function(e,r){return verb.core.Vec.sortedSetUnion(e.knots,r)},[]),x=0,V=e.length;V>x;){var y=x++,S=verb.core.Vec.sortedSetSub(_,e[y].knots);0==S.length&&(e[y]=e[y]),e[y]=verb.eval.Modify.curveKnotRefine(e[y],S)}return e},verb.eval.Modify.imin=function(e,r){return r>e?e:r},verb.eval.Modify.imax=function(e,r){return e>r?e:r},verb.eval.Modify.curveElevateDegree=function(e,r){if(e.degree>=r)return e;var n,t=e.knots.length-e.degree-2,o=e.degree,a=e.knots,i=e.controlPoints,s=r-e.degree,v=e.controlPoints[0].length,c=verb.core.Vec.zeros2d(o+s+1,o+1),u=[],l=[],b=[],h=t+o+1,f=r,d=Math.floor(f/2),m=[],p=[];c[0][0]=1,c[f][o]=1;for(var g=1,_=d+1;_>g;){var x,V=g++,y=1/verb.core.Binomial.get(f,V);x=V>o?o:V;for(var S=verb.eval.Modify.imax(0,V-s),E=x+1;E>S;){var P=S++;c[V][P]=y*verb.core.Binomial.get(o,P)*verb.core.Binomial.get(s,V-P)}}for(var M=d+1;f>M;){var k,I=M++;k=I>o?o:I;for(var A=verb.eval.Modify.imax(0,I-s),N=k+1;N>A;){var C=A++;c[I][C]=c[f-I][o-C]}}var B=f,w=f+1,L=-1,T=o,z=o+1,D=1,U=a[0];m[0]=i[0];for(var O=0,R=f+1;R>O;){var $=O++;p[$]=U}for(var F=0,q=o+1;q>F;){var j=F++;u[j]=i[j]}for(;h>z;){for(var K=z;h>z&&a[z]==a[z+1];)z+=1;var G=z-K+1,W=a[z],H=L;L=o-G;var Y;Y=H>0?Math.floor((H+2)/2):1;var Q;if(Q=L>0?Math.floor(f-(L+1)/2):f,L>0){for(var Z=W-U,J=[],X=o;X>G;)J[X-G-1]=Z/(a[T+X]-U),X--;for(var er=1,rr=L+1;rr>er;){for(var nr=er++,tr=L-nr,or=G+nr,ar=o;ar>=or;)u[ar]=verb.core.Vec.add(verb.core.Vec.mul(J[ar-or],u[ar]),verb.core.Vec.mul(1-J[ar-or],u[ar-1])),ar--;b[tr]=u[o]}}for(var ir=Y,sr=f+1;sr>ir;){var vr=ir++;l[vr]=verb.core.Vec.zeros1d(v);var cr;cr=vr>o?o:vr;for(var ur=verb.eval.Modify.imax(0,vr-s),lr=cr+1;lr>ur;){var br=ur++;l[vr]=verb.core.Vec.add(l[vr],verb.core.Vec.mul(c[vr][br],u[br]))}}if(H>1)for(var hr=w-2,fr=w,dr=W-U,mr=(W-p[w-1])/dr,pr=1;H>pr;){for(var gr=pr++,_r=hr,xr=fr,Vr=xr-w+1;xr-_r>gr;){if(D>_r){var yr=(W-p[_r])/(U-p[_r]);m[_r]=verb.core.Vec.lerp(yr,m[_r],m[_r-1])}if(xr>=Y){if(w-f+H>=xr-gr){var Sr=(W-p[xr-gr])/dr;l[Vr]=verb.core.Vec.lerp(Sr,l[Vr],l[Vr+1])}}else l[Vr]=verb.core.Vec.lerp(mr,l[Vr],l[Vr+1]);_r+=1,xr-=1,Vr-=1}hr-=1,fr+=1}if(T!=o)for(var Er=0,Pr=f-H;Pr>Er;)Er++,p[w]=U,w+=1;for(var Mr=Y,kr=Q+1;kr>Mr;){var Ir=Mr++;m[D]=l[Ir],D+=1}if(h>z){for(var Ar=0;L>Ar;){var Nr=Ar++;u[Nr]=b[Nr]}for(var Cr=L,Br=o+1;Br>Cr;){var wr=Cr++;u[wr]=i[z-o+wr]}T=z,z+=1,U=W}else for(var Lr=0,Tr=f+1;Tr>Lr;){var zr=Lr++;p[w+zr]=W}}return n=B-f-1,new verb.core.NurbsCurveData(r,p,m)},verb.eval.Modify.rationalSurfaceTransform=function(e,r){for(var n=verb.eval.Eval.dehomogenize2d(e.controlPoints),t=0,o=n.length;o>t;)for(var a=t++,i=0,s=n[a].length;s>i;){var v=i++,c=n[a][v];c.push(1),n[a][v]=verb.core.Mat.dot(r,c).slice(0,c.length-1)}return new verb.core.NurbsSurfaceData(e.degreeU,e.degreeV,e.knotsU.slice(),e.knotsV.slice(),verb.eval.Eval.homogenize2d(n,verb.eval.Eval.weight2d(e.controlPoints)))},verb.eval.Modify.rationalCurveTransform=function(e,r){for(var n=verb.eval.Eval.dehomogenize1d(e.controlPoints),t=0,o=n.length;o>t;){var a=t++,i=n[a];i.push(1),n[a]=verb.core.Mat.dot(r,i).slice(0,i.length-1)}return new verb.core.NurbsCurveData(e.degree,e.knots.slice(),verb.eval.Eval.homogenize1d(n,verb.eval.Eval.weight1d(e.controlPoints)))},verb.eval.Modify.surfaceKnotRefine=function(e,r,n){var t,o,a,i=[];n?(a=e.controlPoints,t=e.knotsV,o=e.degreeV):(a=verb.core.Mat.transpose(e.controlPoints),t=e.knotsU,o=e.degreeU);for(var s=null,v=0;a.length>v;){var c=a[v];++v,s=verb.eval.Modify.curveKnotRefine(new verb.core.NurbsCurveData(o,t,c),r),i.push(s.controlPoints)}var u=s.knots;return n?new verb.core.NurbsSurfaceData(e.degreeU,e.degreeV,e.knotsU.slice(),u,i):(i=verb.core.Mat.transpose(i),new verb.core.NurbsSurfaceData(e.degreeU,e.degreeV,u,e.knotsV.slice(),i))},verb.eval.Modify.surfaceSplit=function(e,r,n){null==n&&(n=!1);var t,o,a;n?(a=e.controlPoints,t=e.knotsV,o=e.degreeV):(a=verb.core.Mat.transpose(e.controlPoints),t=e.knotsU,o=e.degreeU);for(var i,s=[],v=0,c=o+1;c>v;)v++,s.push(r);i=s;for(var u=[],l=[],b=verb.eval.Eval.knotSpan(o,r,t),h=null,f=0;a.length>f;){var d=a[f];++f,h=verb.eval.Modify.curveKnotRefine(new verb.core.NurbsCurveData(o,t,d),i),u.push(h.controlPoints.slice(0,b+1)),l.push(h.controlPoints.slice(b+1))}var m=h.knots.slice(0,b+o+2),p=h.knots.slice(b+1);return n?[new verb.core.NurbsSurfaceData(e.degreeU,o,e.knotsU.slice(),m,u),new verb.core.NurbsSurfaceData(e.degreeU,o,e.knotsU.slice(),p,l)]:(u=verb.core.Mat.transpose(u),l=verb.core.Mat.transpose(l),[new verb.core.NurbsSurfaceData(o,e.degreeV,m,e.knotsV.slice(),u),new verb.core.NurbsSurfaceData(o,e.degreeV,p,e.knotsV.slice(),l)])},verb.eval.Modify.decomposeCurveIntoBeziers=function(e){for(var r=e.degree,n=e.controlPoints,t=e.knots,o=verb.eval.Analyze.knotMultiplicities(t),a=r+1,i=0;o.length>i;){var s=o[i];if(++i,a>s.mult){var v=verb.core.Vec.rep(a-s.mult,s.knot),c=verb.eval.Modify.curveKnotRefine(new verb.core.NurbsCurveData(r,t,n),v);t=c.knots,n=c.controlPoints}}t.length/a-1;for(var u=2*a,l=[],b=0;n.length>b;){var h=t.slice(b,b+u),f=n.slice(b,b+a);l.push(new verb.core.NurbsCurveData(r,h,f)),b+=a}return l},verb.eval.Modify.curveSplit=function(e,r){var n=e.degree;e.controlPoints;for(var t,o=e.knots,a=[],i=0,s=n+1;s>i;)i++,a.push(r);t=a;var v=verb.eval.Modify.curveKnotRefine(e,t),c=verb.eval.Eval.knotSpan(n,r,o),u=v.knots.slice(0,c+n+2),l=v.knots.slice(c+1),b=v.controlPoints.slice(0,c+1),h=v.controlPoints.slice(c+1);return[new verb.core.NurbsCurveData(n,u,b),new verb.core.NurbsCurveData(n,l,h)]},verb.eval.Modify.curveKnotRefine=function(e,r){if(0==r.length)return verb.eval.Make.clonedCurve(e);for(var n=e.degree,t=e.controlPoints,o=e.knots,a=t.length-1,i=a+n+1,s=r.length-1,v=verb.eval.Eval.knotSpan(n,r[0],o),c=verb.eval.Eval.knotSpan(n,r[s],o),u=[],l=[],b=0,h=v-n+1;h>b;){var f=b++;u[f]=t[f]}for(var d=c-1,m=a+1;m>d;){var p=d++;u[p+s+1]=t[p]}for(var g=0,_=v+1;_>g;){var x=g++;l[x]=o[x]}for(var V=c+n,y=i+1;y>V;){var S=V++;l[S+s+1]=o[S]}for(var E=c+n-1,P=c+n+s,M=s;M>=0;){for(;r[M]<=o[E]&&E>v;)u[P-n-1]=t[E-n-1],l[P]=o[E],P-=1,E-=1;u[P-n-1]=u[P-n];for(var k=1,I=n+1;I>k;){var A=k++,N=P-n+A,C=l[P+A]-r[M];Math.abs(C)<verb.core.Constants.EPSILON?u[N-1]=u[N]:(C/=l[P+A]-o[E-n+A],u[N-1]=verb.core.Vec.add(verb.core.Vec.mul(C,u[N-1]),verb.core.Vec.mul(1-C,u[N])))}l[P]=r[M],P-=1,M--}return new verb.core.NurbsCurveData(n,l,u)},verb.eval.Modify.curveKnotInsert=function(e,r,n){for(var t=e.degree,o=e.controlPoints,a=e.knots,i=0,s=o.length,v=verb.eval.Eval.knotSpan(t,r,a),c=[],u=[],l=[],b=1,h=v+1;h>b;){var f=b++;u[f]=a[f]}for(var d=1,m=n+1;m>d;){var p=d++;u[v+p]=r}for(var g=v+1,_=a.length;_>g;){var x=g++;u[x+n]=a[x]}for(var V=0,y=v-t+1;y>V;){var S=V++;l[S]=o[S]}for(var E=v-i;s>E;){var P=E++;l[P+n]=o[P]}for(var M=0,k=t-i+1;k>M;){var I=M++;c[I]=o[v-t+I]}for(var A=0,N=0,C=1,B=n+1;B>C;){var w=C++;A=v-t+w;for(var L=0,T=t-w-i+1;T>L;){var z=L++;N=(r-a[A+z])/(a[z+v+1]-a[A+z]),c[z]=verb.core.Vec.add(verb.core.Vec.mul(N,c[z+1]),verb.core.Vec.mul(1-N,c[z]))}l[A]=c[0],l[v+n-w-i]=c[t-w-i]}for(var D=A+1,U=v-i;U>D;){var O=D++;l[O]=c[O-A]}return new verb.core.NurbsCurveData(t,u,l)},verb.eval.Tess=$hx_exports.eval.Tess=function(){},verb.eval.Tess.__name__=["verb","eval","Tess"],verb.eval.Tess.rationalCurveRegularSample=function(e,r,n){return verb.eval.Tess.rationalCurveRegularSampleRange(e,e.knots[0],verb.core.ArrayExtensions.last(e.knots),r,n)},verb.eval.Tess.rationalCurveRegularSampleRange=function(e,r,n,t,o){1>t&&(t=2);for(var a=[],i=(n-r)/(t-1),s=0,v=0;t>v;){var c=v++;s=r+i*c,o?a.push([s].concat(verb.eval.Eval.rationalCurvePoint(e,s))):a.push(verb.eval.Eval.rationalCurvePoint(e,s))}return a},verb.eval.Tess.rationalCurveAdaptiveSample=function(e,r,n){if(null==n&&(n=!1),null==r&&(r=1e-6),1==e.degree){if(n){for(var t=[],o=0,a=e.controlPoints.length;a>o;){var i=o++;t.push([e.knots[i+1]].concat(verb.eval.Eval.dehomogenize(e.controlPoints[i])))}return t}return e.controlPoints.map(verb.eval.Eval.dehomogenize)}return verb.eval.Tess.rationalCurveAdaptiveSampleRange(e,e.knots[0],verb.core.ArrayExtensions.last(e.knots),r,n)},verb.eval.Tess.rationalCurveAdaptiveSampleRange=function(e,r,n,t,o){var a=verb.eval.Eval.rationalCurvePoint(e,r),i=verb.eval.Eval.rationalCurvePoint(e,n),s=.5+.2*Math.random(),v=r+(n-r)*s,c=verb.eval.Eval.rationalCurvePoint(e,v),u=verb.core.Vec.sub(a,i),l=verb.core.Vec.sub(a,c);if(t>verb.core.Vec.dot(u,u)&&verb.core.Vec.dot(l,l)>t||!verb.core.Trig.threePointsAreFlat(a,c,i,t)){var b=r+.5*(n-r),h=verb.eval.Tess.rationalCurveAdaptiveSampleRange(e,r,b,t,o),f=verb.eval.Tess.rationalCurveAdaptiveSampleRange(e,b,n,t,o);return h.slice(0,-1).concat(f)}return o?[[r].concat(a),[n].concat(i)]:[a,i]},verb.eval.Tess.rationalSurfaceNaive=function(e,r,n){1>r&&(r=1),1>n&&(n=1),e.degreeU,e.degreeV,e.controlPoints;for(var t=e.knotsU,o=e.knotsV,a=verb.core.ArrayExtensions.last(t)-t[0],i=verb.core.ArrayExtensions.last(o)-o[0],s=a/r,v=i/n,c=[],u=[],l=[],b=0,h=r+1;h>b;)for(var f=b++,d=0,m=n+1;m>d;){var p=d++,g=f*s,_=p*v;u.push([g,_]);var x=verb.eval.Eval.rationalSurfaceDerivatives(e,g,_,1),V=x[0][0];c.push(V);var y=verb.core.Vec.normalized(verb.core.Vec.cross(x[1][0],x[0][1]));l.push(y)}for(var S=[],E=0;r>E;)for(var P=E++,M=0;n>M;){var k=M++,I=P*(n+1)+k,A=(P+1)*(n+1)+k,N=A+1,C=I+1,B=[I,A,N],w=[I,N,C];S.push(B),S.push(w)}return new verb.core.MeshData(S,c,l,u)},verb.eval.Tess.divideRationalSurfaceAdaptive=function(e,r){null==r&&(r=new verb.core.AdaptiveRefinementOptions),r.minDivsU=null!=r.minDivsU?r.minDivsU:1,r.minDivsU=null!=r.minDivsV?r.minDivsV:1,r.refine=null!=r.refine?r.refine:!0;var n,t=2*(e.controlPoints.length-1),o=2*(e.controlPoints[0].length-1);n=r.minDivsU=r.minDivsU>t?r.minDivsU:t;var a;a=r.minDivsV=r.minDivsV>o?r.minDivsV:o;for(var i=verb.core.ArrayExtensions.last(e.knotsU),s=e.knotsU[0],v=verb.core.ArrayExtensions.last(e.knotsV),c=e.knotsV[0],u=(i-s)/n,l=(v-c)/a,b=[],h=[],f=0,d=a+1;d>f;){for(var m=f++,p=[],g=0,_=n+1;_>g;){var x=g++,V=s+u*x,y=c+l*m,S=verb.eval.Eval.rationalSurfaceDerivatives(e,V,y,1),E=verb.core.Vec.normalized(verb.core.Vec.cross(S[0][1],S[1][0]));p.push(new verb.core.SurfacePoint(S[0][0],E,[V,y],-1,verb.core.Vec.isZero(E)))}h.push(p)}for(var P=0;a>P;)for(var M=P++,k=0;n>k;){var I=k++,A=[h[a-M-1][I],h[a-M-1][I+1],h[a-M][I+1],h[a-M][I]];b.push(new verb.core.AdaptiveRefinementNode(e,A))}if(!r.refine)return b;for(var N=0;a>N;)for(var C=N++,B=0;n>B;){var w=B++,L=C*n+w,T=verb.eval.Tess.north(L,C,w,n,a,b),z=verb.eval.Tess.east(L,C,w,n,a,b),D=verb.eval.Tess.south(L,C,w,n,a,b),U=verb.eval.Tess.west(L,C,w,n,a,b);b[L].neighbors=[D,z,T,U],b[L].divide(r)}return b},verb.eval.Tess.north=function(e,r,n,t,o,a){return 0==r?null:a[e-t]},verb.eval.Tess.south=function(e,r,n,t,o,a){return r==o-1?null:a[e+t]},verb.eval.Tess.east=function(e,r,n,t,o,a){return n==t-1?null:a[e+1]},verb.eval.Tess.west=function(e,r,n,t,o,a){return 0==n?null:a[e-1]},verb.eval.Tess.triangulateAdaptiveRefinementNodeTree=function(e){for(var r=verb.core.MeshData.empty(),n=0;e.length>n;){var t=e[n];++n,t.triangulate(r)}return r},verb.eval.Tess.rationalSurfaceAdaptive=function(e,r){r=null!=r?r:new verb.core.AdaptiveRefinementOptions;var n=verb.eval.Tess.divideRationalSurfaceAdaptive(e,r);return verb.eval.Tess.triangulateAdaptiveRefinementNodeTree(n)},verb.exe={},verb.exe.AsyncObject=$hx_exports.exe.AsyncObject=function(){},verb.exe.AsyncObject.__name__=["verb","exe","AsyncObject"],verb.exe.AsyncObject.prototype={defer:function(e,r,n){return verb.exe.Dispatcher.dispatchMethod(e,r,n)}},verb.exe.Dispatcher=function(){},verb.exe.Dispatcher.__name__=["verb","exe","Dispatcher"],verb.exe.Dispatcher.init=function(){verb.exe.Dispatcher._init||(verb.exe.Dispatcher._workerPool=new verb.exe.WorkerPool(verb.exe.Dispatcher.THREADS),verb.exe.Dispatcher._init=!0)},verb.exe.Dispatcher.dispatchMethod=function(e,r,n){verb.exe.Dispatcher.init();var t=new promhx.Deferred,o=function(e){t.resolve(e)};return verb.exe.Dispatcher._workerPool.addWork(Type.getClassName(e),r,n,o),new promhx.Promise(t)},verb.exe.Work=$hx_exports.exe.Work=function(e,r,n){this.className=e,this.methodName=r,this.args=n,this.id=verb.exe.Work.uuid++},verb.exe.Work.__name__=["verb","exe","Work"],verb.exe.WorkerPool=$hx_exports.exe.WorkerPool=function(e,r){null==r&&(r="verb.js"),this._callbacks=new haxe.ds.IntMap,this._working=new haxe.ds.IntMap,this._pool=[],this._queue=[];for(var n=0;e>n;)n++,this._pool.push(new Worker(verb.exe.WorkerPool.basePath+r))},verb.exe.WorkerPool.__name__=["verb","exe","WorkerPool"],verb.exe.WorkerPool.prototype={addWork:function(e,r,n,t){var o=new verb.exe.Work(e,r,n);this._callbacks.set(o.id,t),this._queue.push(o),this.processQueue()},processQueue:function(){for(var e=this;this._queue.length>0&&this._pool.length>0;){var r=this._queue.shift(),n=[r.id],t=[this._pool.shift()];this._working.set(n[0],t[0]),t[0].onmessage=function(r,n){return function(t){e._working.remove(n[0]),e._pool.push(r[0]);try{e._callbacks.exists(n[0])&&(e._callbacks.get(n[0])(t.data.result),e._callbacks.remove(n[0]))}catch(o){haxe.Log.trace(o,{fileName:"WorkerPool.hx",lineNumber:78,className:"verb.exe.WorkerPool",methodName:"processQueue"})}e.processQueue()}}(t,n),t[0].postMessage(r)}}},verb.geom={},verb.geom.ICurve=function(){},verb.geom.ICurve.__name__=["verb","geom","ICurve"],verb.geom.NurbsCurve=$hx_exports.geom.NurbsCurve=function(e){this._data=verb.eval.Check.nurbsCurveData(e)},verb.geom.NurbsCurve.__name__=["verb","geom","NurbsCurve"],verb.geom.NurbsCurve.__interfaces__=[verb.geom.ICurve],verb.geom.NurbsCurve.byKnotsControlPointsWeights=function(e,r,n,t){return new verb.geom.NurbsCurve(new verb.core.NurbsCurveData(e,r.slice(),verb.eval.Eval.homogenize1d(n,t)))},verb.geom.NurbsCurve.byPoints=function(e,r){return null==r&&(r=3),new verb.geom.NurbsCurve(verb.eval.Make.rationalInterpCurve(e,r))},verb.geom.NurbsCurve.__super__=verb.exe.AsyncObject,verb.geom.NurbsCurve.prototype=$extend(verb.exe.AsyncObject.prototype,{degree:function(){return this._data.degree},knots:function(){return this._data.knots.slice(0)},controlPoints:function(){return verb.eval.Eval.dehomogenize1d(this._data.controlPoints)},weights:function(){return verb.eval.Eval.weight1d(this._data.controlPoints)},asNurbs:function(){return new verb.core.NurbsCurveData(this.degree(),this.knots(),verb.eval.Eval.homogenize1d(this.controlPoints(),this.weights()))},clone:function(){return new verb.geom.NurbsCurve(this._data)},domain:function(){return new verb.core.Interval(verb.core.ArrayExtensions.first(this._data.knots),verb.core.ArrayExtensions.last(this._data.knots))},transform:function(e){return new verb.geom.NurbsCurve(verb.eval.Modify.rationalCurveTransform(this._data,e))},transformAsync:function(e){return this.defer(verb.eval.Modify,"rationalCurveTransform",[this._data,e]).then(function(e){return new verb.geom.NurbsCurve(e)})},point:function(e){return verb.eval.Eval.rationalCurvePoint(this._data,e)},pointAsync:function(e){return this.defer(verb.eval.Eval,"rationalCurvePoint",[this._data,e])},tangent:function(e){return verb.eval.Eval.rationalCurveTangent(this._data,e)},tangentAsync:function(e){return this.defer(verb.eval.Eval,"rationalCurveTangent",[this._data,e])},derivatives:function(e,r){return null==r&&(r=1),verb.eval.Eval.rationalCurveDerivatives(this._data,e,r)},derivativesAsync:function(e,r){return null==r&&(r=1),this.defer(verb.eval.Eval,"rationalCurveDerivatives",[this._data,e,r])},closestPoint:function(e){return verb.eval.Analyze.rationalCurveClosestPoint(this._data,e)},closestPointAsync:function(e){return this.defer(verb.eval.Analyze,"rationalCurveClosestPoint",[this._data,e])},closestParam:function(e){return verb.eval.Analyze.rationalCurveClosestParam(this._data,e)},closestParamAsync:function(e){return this.defer(verb.eval.Analyze,"rationalCurveClosestParam",[this._data,e])},length:function(){return verb.eval.Analyze.rationalCurveArcLength(this._data)},lengthAsync:function(){return this.defer(verb.eval.Analyze,"rationalCurveArcLength",[this._data])},lengthAtParam:function(e){return verb.eval.Analyze.rationalCurveArcLength(this._data,e)},lengthAtParamAsync:function(){return this.defer(verb.eval.Analyze,"rationalCurveArcLength",[this._data])},paramAtLength:function(e,r){return verb.eval.Analyze.rationalCurveParamAtArcLength(this._data,e,r)},paramAtLengthAsync:function(e,r){return this.defer(verb.eval.Analyze,"rationalCurveParamAtArcLength",[this._data,e,r])},divideByEqualArcLength:function(e){return verb.eval.Divide.rationalCurveByEqualArcLength(this._data,e)},divideByEqualArcLengthAsync:function(e){return this.defer(verb.eval.Divide,"rationalCurveByEqualArcLength",[this._data,e])},divideByArcLength:function(e){return verb.eval.Divide.rationalCurveByArcLength(this._data,e)},divideByArcLengthAsync:function(e){return this.defer(verb.eval.Divide,"rationalCurveByArcLength",[this._data,e])},split:function(e){return verb.eval.Modify.curveSplit(this._data,e).map(function(e){return new verb.geom.NurbsCurve(e)})},splitAsync:function(e){return this.defer(verb.eval.Modify,"curveSplit",[this._data,e]).then(function(e){return e.map(function(e){return new verb.geom.NurbsCurve(e)})})},reverse:function(){return new verb.geom.NurbsCurve(verb.eval.Modify.curveReverse(this._data))},reverseAsync:function(){return this.defer(verb.eval.Modify,"curveReverse",[this._data]).then(function(e){return new verb.geom.NurbsCurve(e)})},tessellate:function(e){return verb.eval.Tess.rationalCurveAdaptiveSample(this._data,e,!1)},tessellateAsync:function(e){return this.defer(verb.eval.Tess,"rationalCurveAdaptiveSample",[this._data,e,!1])}}),verb.geom.Arc=$hx_exports.geom.Arc=function(e,r,n,t,o,a){verb.geom.NurbsCurve.call(this,verb.eval.Make.arc(e,r,n,t,o,a)),this._center=e,this._xaxis=r,this._yaxis=n,this._radius=t,this._minAngle=o,this._maxAngle=a},verb.geom.Arc.__name__=["verb","geom","Arc"],verb.geom.Arc.__super__=verb.geom.NurbsCurve,verb.geom.Arc.prototype=$extend(verb.geom.NurbsCurve.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},radius:function(){return this._radius},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle}}),verb.geom.BezierCurve=$hx_exports.geom.BezierCurve=function(e,r){verb.geom.NurbsCurve.call(this,verb.eval.Make.rationalBezierCurve(e,r))},verb.geom.BezierCurve.__name__=["verb","geom","BezierCurve"],verb.geom.BezierCurve.__super__=verb.geom.NurbsCurve,verb.geom.BezierCurve.prototype=$extend(verb.geom.NurbsCurve.prototype,{}),verb.geom.Circle=$hx_exports.geom.Circle=function(e,r,n,t){verb.geom.Arc.call(this,e,r,n,t,0,2*Math.PI)
},verb.geom.Circle.__name__=["verb","geom","Circle"],verb.geom.Circle.__super__=verb.geom.Arc,verb.geom.Circle.prototype=$extend(verb.geom.Arc.prototype,{}),verb.geom.ISurface=function(){},verb.geom.ISurface.__name__=["verb","geom","ISurface"],verb.geom.NurbsSurface=$hx_exports.geom.NurbsSurface=function(e){this._data=verb.eval.Check.nurbsSurfaceData(e)},verb.geom.NurbsSurface.__name__=["verb","geom","NurbsSurface"],verb.geom.NurbsSurface.__interfaces__=[verb.geom.ISurface],verb.geom.NurbsSurface.byKnotsControlPointsWeights=function(e,r,n,t,o,a){return new verb.geom.NurbsSurface(new verb.core.NurbsSurfaceData(e,r,n,t,verb.eval.Eval.homogenize2d(o,a)))},verb.geom.NurbsSurface.byCorners=function(e,r,n,t){return new verb.geom.NurbsSurface(verb.eval.Make.fourPointSurface(e,r,n,t))},verb.geom.NurbsSurface.byLoftingCurves=function(e,r){return new verb.geom.NurbsSurface(verb.eval.Make.loftedSurface(function(){for(var r,n=[],t=0;e.length>t;){var o=e[t];++t,n.push(o.asNurbs())}return r=n}(this),r))},verb.geom.NurbsSurface.__super__=verb.exe.AsyncObject,verb.geom.NurbsSurface.prototype=$extend(verb.exe.AsyncObject.prototype,{degreeU:function(){return this._data.degreeU},degreeV:function(){return this._data.degreeV},knotsU:function(){return this._data.knotsU.slice(0)},knotsV:function(){return this._data.knotsV.slice(0)},controlPoints:function(){return verb.eval.Eval.dehomogenize2d(this._data.controlPoints)},weights:function(){return verb.eval.Eval.weight2d(this._data.controlPoints)},asNurbs:function(){return new verb.core.NurbsSurfaceData(this.degreeU(),this.degreeV(),this.knotsU(),this.knotsV(),verb.eval.Eval.homogenize2d(this.controlPoints(),this.weights()))},clone:function(){return new verb.geom.NurbsSurface(this.asNurbs())},domainU:function(){return new verb.core.Interval(verb.core.ArrayExtensions.first(this._data.knotsU),verb.core.ArrayExtensions.last(this._data.knotsU))},domainV:function(){return new verb.core.Interval(verb.core.ArrayExtensions.first(this._data.knotsV),verb.core.ArrayExtensions.last(this._data.knotsV))},point:function(e,r){return verb.eval.Eval.rationalSurfacePoint(this._data,e,r)},pointAsync:function(e,r){return this.defer(verb.eval.Eval,"rationalSurfacePoint",[this._data,e,r])},normal:function(e,r){return verb.eval.Eval.rationalSurfaceNormal(this._data,e,r)},normalAsync:function(e,r){return this.defer(verb.eval.Eval,"rationalSurfaceNormal",[this._data,e,r])},derivatives:function(e,r,n){return null==n&&(n=1),verb.eval.Eval.rationalSurfaceDerivatives(this._data,e,r,n)},derivativesAsync:function(e,r,n){return null==n&&(n=1),this.defer(verb.eval.Eval,"rationalSurfaceDerivatives",[this._data,e,r,n])},closestParam:function(e){return verb.eval.Analyze.rationalSurfaceClosestParam(this._data,e)},closestParamAsync:function(e){return this.defer(verb.eval.Analyze,"rationalSurfaceClosestParam",[this._data,e])},closestPoint:function(e){return verb.eval.Analyze.rationalSurfaceClosestPoint(this._data,e)},closestPointAsync:function(e){return this.defer(verb.eval.Analyze,"rationalSurfaceClosestPoint",[this._data,e])},split:function(e,r){return null==r&&(r=!1),verb.eval.Modify.surfaceSplit(this._data,e,r).map(function(e){return new verb.geom.NurbsSurface(e)})},splitAsync:function(e,r){return null==r&&(r=!1),this.defer(verb.eval.Modify,"surfaceSplit",[this._data,e,r]).then(function(e){return e.map(function(e){return new verb.geom.NurbsSurface(e)})})},reverse:function(e){return null==e&&(e=!1),new verb.geom.NurbsSurface(verb.eval.Modify.surfaceReverse(this._data,e))},reverseAsync:function(e){return null==e&&(e=!1),this.defer(verb.eval.Modify,"surfaceReverse",[this._data,e]).then(function(e){return new verb.geom.NurbsSurface(e)})},isocurve:function(e,r){return null==r&&(r=!1),new verb.geom.NurbsCurve(verb.eval.Make.surfaceIsocurve(this._data,e,r))},isocurveAsync:function(e,r){return null==r&&(r=!1),this.defer(verb.eval.Make,"surfaceIsocurve",[this._data,e,r]).then(function(e){return new verb.geom.NurbsCurve(e)})},boundaries:function(){return verb.eval.Make.surfaceBoundaryCurves(this._data).map(function(e){return new verb.geom.NurbsCurve(e)})},boundariesAsync:function(){return this.defer(verb.eval.Make,"surfaceBoundaryCurves",[this._data]).then(function(e){return e.map(function(e){return new verb.geom.NurbsCurve(e)})})},tessellate:function(e){return verb.eval.Tess.rationalSurfaceAdaptive(this._data,e)},tessellateAsync:function(e){return this.defer(verb.eval.Tess,"rationalSurfaceAdaptive",[this._data,e])},transform:function(e){return new verb.geom.NurbsSurface(verb.eval.Modify.rationalSurfaceTransform(this._data,e))},transformAsync:function(e){return this.defer(verb.eval.Modify,"rationalSurfaceTransform",[this._data,e]).then(function(e){return new verb.geom.NurbsSurface(e)})}}),verb.geom.ConicalSurface=$hx_exports.geom.ConicalSurface=function(e,r,n,t,o){verb.geom.NurbsSurface.call(this,verb.eval.Make.conicalSurface(e,r,n,t,o)),this._axis=e,this._xaxis=r,this._base=n,this._height=t,this._radius=o},verb.geom.ConicalSurface.__name__=["verb","geom","ConicalSurface"],verb.geom.ConicalSurface.__super__=verb.geom.NurbsSurface,verb.geom.ConicalSurface.prototype=$extend(verb.geom.NurbsSurface.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius}}),verb.geom.CylindricalSurface=$hx_exports.geom.CylindricalSurface=function(e,r,n,t,o){verb.geom.NurbsSurface.call(this,verb.eval.Make.cylindricalSurface(e,r,n,t,o)),this._axis=e,this._xaxis=r,this._base=n,this._height=t,this._radius=o},verb.geom.CylindricalSurface.__name__=["verb","geom","CylindricalSurface"],verb.geom.CylindricalSurface.__super__=verb.geom.NurbsSurface,verb.geom.CylindricalSurface.prototype=$extend(verb.geom.NurbsSurface.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius}}),verb.geom.EllipseArc=$hx_exports.geom.EllipseArc=function(e,r,n,t,o){verb.geom.NurbsCurve.call(this,verb.eval.Make.ellipseArc(e,r,n,t,o)),this._center=e,this._xaxis=r,this._yaxis=n,this._minAngle=t,this._maxAngle=o},verb.geom.EllipseArc.__name__=["verb","geom","EllipseArc"],verb.geom.EllipseArc.__super__=verb.geom.NurbsCurve,verb.geom.EllipseArc.prototype=$extend(verb.geom.NurbsCurve.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle}}),verb.geom.Ellipse=$hx_exports.geom.Ellipse=function(e,r,n){verb.geom.EllipseArc.call(this,e,r,n,0,2*Math.PI)},verb.geom.Ellipse.__name__=["verb","geom","Ellipse"],verb.geom.Ellipse.__super__=verb.geom.EllipseArc,verb.geom.Ellipse.prototype=$extend(verb.geom.EllipseArc.prototype,{}),verb.geom.ExtrudedSurface=$hx_exports.geom.ExtrudedSurface=function(e,r){verb.geom.NurbsSurface.call(this,verb.eval.Make.extrudedSurface(verb.core.Vec.normalized(r),verb.core.Vec.norm(r),e.asNurbs())),this._profile=e,this._direction=r},verb.geom.ExtrudedSurface.__name__=["verb","geom","ExtrudedSurface"],verb.geom.ExtrudedSurface.__super__=verb.geom.NurbsSurface,verb.geom.ExtrudedSurface.prototype=$extend(verb.geom.NurbsSurface.prototype,{profile:function(){return this._profile},direction:function(){return this._direction}}),verb.geom.Intersect=$hx_exports.geom.Intersect=function(){},verb.geom.Intersect.__name__=["verb","geom","Intersect"],verb.geom.Intersect.curves=function(e,r,n){return null==n&&(n=.001),verb.eval.Intersect.curves(e.asNurbs(),r.asNurbs(),n)},verb.geom.Intersect.curvesAsync=function(e,r,n){return null==n&&(n=.001),verb.exe.Dispatcher.dispatchMethod(verb.eval.Intersect,"curves",[e.asNurbs(),r.asNurbs(),n])},verb.geom.Intersect.curveAndSurface=function(e,r,n){return null==n&&(n=.001),verb.eval.Intersect.curveAndSurface(e.asNurbs(),r.asNurbs(),n)},verb.geom.Intersect.curveAndSurfaceAsync=function(e,r,n){return null==n&&(n=.001),verb.exe.Dispatcher.dispatchMethod(verb.eval.Intersect,"curveAndSurface",[e.asNurbs(),r.asNurbs(),n])},verb.geom.Intersect.surfaces=function(e,r,n){return null==n&&(n=.001),verb.eval.Intersect.surfaces(e.asNurbs(),r.asNurbs(),n).map(function(e){return new verb.geom.NurbsCurve(e)})},verb.geom.Intersect.surfacesAsync=function(e,r,n){return null==n&&(n=.001),verb.exe.Dispatcher.dispatchMethod(verb.eval.Intersect,"surfaces",[e.asNurbs(),r.asNurbs(),n]).then(function(e){return e.map(function(e){return new verb.geom.NurbsCurve(e)})})},verb.geom.Line=$hx_exports.geom.Line=function(e,r){verb.geom.NurbsCurve.call(this,verb.eval.Make.polyline([e,r])),this._start=e,this._end=r},verb.geom.Line.__name__=["verb","geom","Line"],verb.geom.Line.__super__=verb.geom.NurbsCurve,verb.geom.Line.prototype=$extend(verb.geom.NurbsCurve.prototype,{start:function(){return this._start},end:function(){return this._end}}),verb.geom.RevolvedSurface=$hx_exports.geom.RevolvedSurface=function(e,r,n,t){verb.geom.NurbsSurface.call(this,verb.eval.Make.revolvedSurface(e.asNurbs(),r,n,t)),this._profile=e,this._center=r,this._axis=n,this._angle=t},verb.geom.RevolvedSurface.__name__=["verb","geom","RevolvedSurface"],verb.geom.RevolvedSurface.__super__=verb.geom.NurbsSurface,verb.geom.RevolvedSurface.prototype=$extend(verb.geom.NurbsSurface.prototype,{profile:function(){return this._profile},center:function(){return this._center},axis:function(){return this._center},angle:function(){return this._angle}}),verb.geom.SphericalSurface=$hx_exports.geom.SphericalSurface=function(e,r){verb.geom.NurbsSurface.call(this,verb.eval.Make.sphericalSurface(e,[0,0,1],[1,0,0],r)),this._center=e,this._radius=r},verb.geom.SphericalSurface.__name__=["verb","geom","SphericalSurface"],verb.geom.SphericalSurface.__super__=verb.geom.NurbsSurface,verb.geom.SphericalSurface.prototype=$extend(verb.geom.NurbsSurface.prototype,{center:function(){return this._center},radius:function(){return this._radius}}),verb.geom.SweptSurface=$hx_exports.geom.SweptSurface=function(e,r){verb.geom.NurbsSurface.call(this,verb.eval.Make.rationalTranslationalSurface(e.asNurbs(),r.asNurbs())),this._profile=e,this._rail=r},verb.geom.SweptSurface.__name__=["verb","geom","SweptSurface"],verb.geom.SweptSurface.__super__=verb.geom.NurbsSurface,verb.geom.SweptSurface.prototype=$extend(verb.geom.NurbsSurface.prototype,{profile:function(){return this._profile},rail:function(){return this._rail}});var $_,$fid=0;Math.NaN=Number.NaN,Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Math.isFinite=function(e){return isFinite(e)},Math.isNaN=function(e){return isNaN(e)},String.__name__=["String"],Array.__name__=["Array"],null==Array.prototype.map&&(Array.prototype.map=function(e){for(var r=[],n=0,t=this.length;t>n;){var o=n++;r[o]=e(this[o])}return r}),null==Array.prototype.filter&&(Array.prototype.filter=function(e){for(var r=[],n=0,t=this.length;t>n;){var o=n++,a=this[o];e(a)&&r.push(a)}return r});var global=window;(function(global,undefined){function canUseNextTick(){return"object"==typeof process&&"[object process]"===Object.prototype.toString.call(process)}function canUseMessageChannel(){return!!global.MessageChannel}function canUsePostMessage(){if(!global.postMessage||global.importScripts)return!1;var e=!0,r=global.onmessage;return global.onmessage=function(){e=!1},global.postMessage("","*"),global.onmessage=r,e}function canUseReadyStateChange(){return"document"in global&&"onreadystatechange"in global.document.createElement("script")}function installNextTickImplementation(e){e.setImmediate=function(){var e=tasks.addFromSetImmediateArguments(arguments);return process.nextTick(function(){tasks.runIfPresent(e)}),e}}function installMessageChannelImplementation(e){var r=new global.MessageChannel;r.port1.onmessage=function(e){var r=e.data;tasks.runIfPresent(r)},e.setImmediate=function(){var e=tasks.addFromSetImmediateArguments(arguments);return r.port2.postMessage(e),e}}function installPostMessageImplementation(e){function r(e,r){return"string"==typeof e&&e.substring(0,r.length)===r}function n(e){if(e.source===global&&r(e.data,t)){var n=e.data.substring(t.length);tasks.runIfPresent(n)}}var t="com.bn.NobleJS.setImmediate"+Math.random();global.addEventListener?global.addEventListener("message",n,!1):global.attachEvent("onmessage",n),e.setImmediate=function(){var e=tasks.addFromSetImmediateArguments(arguments);return global.postMessage(t+e,"*"),e}}function installReadyStateChangeImplementation(e){e.setImmediate=function(){var e=tasks.addFromSetImmediateArguments(arguments),r=global.document.createElement("script");return r.onreadystatechange=function(){tasks.runIfPresent(e),r.onreadystatechange=null,r.parentNode.removeChild(r),r=null},global.document.documentElement.appendChild(r),e}}function installSetTimeoutImplementation(e){e.setImmediate=function(){var e=tasks.addFromSetImmediateArguments(arguments);return global.setTimeout(function(){tasks.runIfPresent(e)},0),e}}var tasks=function(){function Task(e,r){this.handler=e,this.args=r}Task.prototype.run=function(){if("function"==typeof this.handler)this.handler.apply(undefined,this.args);else{var scriptSource=""+this.handler;eval(scriptSource)}};var nextHandle=1,tasksByHandle={},currentlyRunningATask=!1;return{addFromSetImmediateArguments:function(e){var r=e[0],n=Array.prototype.slice.call(e,1),t=new Task(r,n),o=nextHandle++;return tasksByHandle[o]=t,o},runIfPresent:function(e){if(currentlyRunningATask)global.setTimeout(function(){tasks.runIfPresent(e)},0);else{var r=tasksByHandle[e];if(r){currentlyRunningATask=!0;try{r.run()}finally{delete tasksByHandle[e],currentlyRunningATask=!1}}}},remove:function(e){delete tasksByHandle[e]}}}();if(!global.setImmediate){var attachTo="function"==typeof Object.getPrototypeOf&&"setTimeout"in Object.getPrototypeOf(global)?Object.getPrototypeOf(global):global;canUseNextTick()?installNextTickImplementation(attachTo):canUsePostMessage()?installPostMessageImplementation(attachTo):canUseMessageChannel()?installMessageChannelImplementation(attachTo):canUseReadyStateChange()?installReadyStateChangeImplementation(attachTo):installSetTimeoutImplementation(attachTo),attachTo.clearImmediate=tasks.remove}})("object"==typeof global&&global?global:this),promhx.base.EventLoop.queue=new List,verb.core.Binomial.memo=new haxe.ds.IntMap,verb.core.BoundingBox.TOLERANCE=1e-4,verb.core.Constants.TOLERANCE=1e-6,verb.core.Constants.EPSILON=1e-10,verb.eval.Analyze.Tvalues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],verb.eval.Analyze.Cvalues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],verb.eval.ExpIntersect.INIT_STEP_LENGTH=.001,verb.eval.ExpIntersect.LINEAR_STEP_LENGTH=.1,verb.exe.Dispatcher.THREADS=1,verb.exe.Dispatcher._init=!1,verb.exe.Work.uuid=0,verb.exe.WorkerPool.basePath="",verb.Verb.main()})(verb!==void 0?verb:exports);